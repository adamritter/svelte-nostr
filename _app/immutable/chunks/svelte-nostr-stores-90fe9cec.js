var Ir=Object.defineProperty;var Pr=(e,t,n)=>t in e?Ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Fe=(e,t,n)=>(Pr(e,typeof t!="symbol"?t+"":t,n),n);import{v as Mr,b as Fr,m as Nr,K as ge}from"./nostr.esm-d2518f25.js";import{r as Qn,d as dn,w as Gn}from"./index-fd964354.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var D=function(){return D=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},D.apply(this,arguments)};function Vt(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var M=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N=Object.keys,U=Array.isArray;typeof Promise<"u"&&!M.Promise&&(M.Promise=Promise);function z(e,t){return typeof t!="object"||N(t).forEach(function(n){e[n]=t[n]}),e}var qe=Object.getPrototypeOf,jr={}.hasOwnProperty;function H(e,t){return jr.call(e,t)}function Oe(e,t){typeof t=="function"&&(t=t(qe(e))),(typeof Reflect>"u"?N:Reflect.ownKeys)(t).forEach(function(n){ue(e,n,t[n])})}var Jn=Object.defineProperty;function ue(e,t,n,r){Jn(e,t,z(n&&H(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function De(e){return{from:function(t){return e.prototype=Object.create(t.prototype),ue(e.prototype,"constructor",e),{extend:Oe.bind(null,e.prototype)}}}}var Lr=Object.getOwnPropertyDescriptor;function pn(e,t){var n=Lr(e,t),r;return n||(r=qe(e))&&pn(r,t)}var Vr=[].slice;function kt(e,t,n){return Vr.call(e,t,n)}function Xn(e,t){return t(e)}function Le(e){if(!e)throw new Error("Assertion Failed")}function $n(e){M.setImmediate?setImmediate(e):setTimeout(e,0)}function Zn(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function Ur(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}function oe(e,t){if(H(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=oe(e,t[r]);n.push(a)}return n}var o=t.indexOf(".");if(o!==-1){var u=e[t.substr(0,o)];return u===void 0?void 0:oe(u,t.substr(o+1))}}function X(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Le(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)X(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var o=t.substr(0,a),u=t.substr(a+1);if(u==="")n===void 0?U(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var s=e[o];(!s||!H(e,o))&&(s=e[o]={}),X(s,u,n)}}else n===void 0?U(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Wr(e,t){typeof t=="string"?X(e,t,void 0):"length"in t&&[].map.call(t,function(n){X(e,n,void 0)})}function er(e){var t={};for(var n in e)H(e,n)&&(t[n]=e[n]);return t}var zr=[].concat;function tr(e){return zr.apply([],e)}var nr="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(tr([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return M[e]}),qr=nr.map(function(e){return M[e]});Zn(nr,function(e){return[e,!0]});var he=null;function $e(e){he=typeof WeakMap<"u"&&new WeakMap;var t=Ut(e);return he=null,t}function Ut(e){if(!e||typeof e!="object")return e;var t=he&&he.get(e);if(t)return t;if(U(e)){t=[],he&&he.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(Ut(e[n]))}else if(qr.indexOf(e.constructor)>=0)t=e;else{var i=qe(e);t=i===Object.prototype?{}:Object.create(i),he&&he.set(e,t);for(var a in e)H(e,a)&&(t[a]=Ut(e[a]))}return t}var Hr={}.toString;function Wt(e){return Hr.call(e).slice(8,-1)}var zt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Yr=typeof zt=="symbol"?function(e){var t;return e!=null&&(t=e[zt])&&t.apply(e)}:function(){return null},Ke={};function ie(e){var t,n,r,i;if(arguments.length===1){if(U(e))return e.slice();if(this===Ke&&typeof e=="string")return[e];if(i=Yr(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var vn=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},te=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function rr(e,t){te=e,ir=t}var ir=function(){return!0},Qr=!new Error("").stack;function xe(){if(Qr)try{throw xe.arguments,new Error}catch(e){return e}return new Error}function qt(e,t){var n=e.stack;return n?(t=t||0,n.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),n.split(`
`).slice(t).filter(ir).map(function(r){return`
`+r}).join("")):""}var Gr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],ar=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],yn=Gr.concat(ar),Jr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Be(e,t){this._e=xe(),this.name=e,this.message=t}De(Be).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+qt(this._e,2))}},toString:function(){return this.name+": "+this.message}});function or(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function mt(e,t,n,r){this._e=xe(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=or(e,t)}De(mt).from(Be);function Ue(e,t){this._e=xe(),this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=or(e,t)}De(Ue).from(Be);var mn=yn.reduce(function(e,t){return e[t]=t+"Error",e},{}),Xr=Be,T=yn.reduce(function(e,t){var n=t+"Error";function r(i,a){this._e=xe(),this.name=n,i?typeof i=="string"?(this.message=""+i+(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Jr[t]||n,this.inner=null)}return De(r).from(Xr),e[t]=r,e},{});T.Syntax=SyntaxError;T.Type=TypeError;T.Range=RangeError;var In=ar.reduce(function(e,t){return e[t+"Error"]=T[t],e},{});function $r(e,t){if(!e||e instanceof Be||e instanceof TypeError||e instanceof SyntaxError||!e.name||!In[e.name])return e;var n=new In[e.name](t||e.message,e);return"stack"in e&&ue(n,"stack",{get:function(){return this.inner.stack}}),n}var Kt=yn.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=T[t]),e},{});Kt.ModifyError=mt;Kt.DexieError=Be;Kt.BulkError=Ue;function P(){}function Ze(e){return e}function Zr(e,t){return e==null||e===Ze?t:function(n){return t(e(n))}}function Ee(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ei(e,t){return e===P?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ee(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ee(i,this.onerror):i),a!==void 0?a:n}}function ti(e,t){return e===P?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ee(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ee(r,this.onerror):r)}}function ni(e,t){return e===P?t:function(n){var r=e.apply(this,arguments);z(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ee(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Ee(a,this.onerror):a),r===void 0?o===void 0?void 0:o:z(r,o)}}function ri(e,t){return e===P?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function gn(e,t){return e===P?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var He={},ii=100,ai=20,ur=100,bn=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,qe(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,qe(t),e]}(),Ht=bn[0],gt=bn[1],Yt=bn[2],sr=gt&&gt.then,ct=Ht&&Ht.constructor,_n=!!Yt,Qt=!1,oi=Yt?function(){Yt.then(at)}:M.setImmediate?setImmediate.bind(null,at):M.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){at(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(at,0)},Ye=function(e,t){Ve.push([e,t]),bt&&(oi(),bt=!1)},Gt=!0,bt=!0,_e=[],ft=[],Jt=null,Xt=Ze,Te={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Fn,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{Fn(e[0],e[1])}catch{}})}},k=Te,Ve=[],we=0,ht=[];function x(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=P,this._lib=!1;var t=this._PSD=k;if(te&&(this._stackHolder=xe(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==He)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Zt(this,this._value);return}this._state=null,this._value=null,++t.ref,cr(this,e)}var $t={get:function(){var e=k,t=_t;function n(r,i){var a=this,o=!e.global&&(e!==k||t!==_t),u=o&&!se(),s=new x(function(l,d){wn(a,new lr(Et(r,e,o,u),Et(i,e,o,u),l,d,e))});return te&&dr(s,this),s}return n.prototype=He,n},set:function(e){ue(this,"then",e&&e.prototype===He?$t:{get:function(){return e},set:$t.set})}};Oe(x.prototype,{then:$t,_then:function(e,t){wn(this,new lr(null,null,e,t,k))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):dt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):dt(r)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),dt(t)})},stack:{get:function(){if(this._stack)return this._stack;try{Qt=!0;var e=hr(this,[],ai),t=e.join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Qt=!1}}},timeout:function(e,t){var n=this;return e<1/0?new x(function(r,i){var a=setTimeout(function(){return i(new T.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&ue(x.prototype,Symbol.toStringTag,"Dexie.Promise");Te.env=pr();function lr(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}Oe(x,{all:function(){var e=ie.apply(null,arguments).map(wt);return new x(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return x.resolve(i).then(function(o){e[a]=o,--r||t(e)},n)})})},resolve:function(e){if(e instanceof x)return e;if(e&&typeof e.then=="function")return new x(function(n,r){e.then(n,r)});var t=new x(He,!0,e);return dr(t,Jt),t},reject:dt,race:function(){var e=ie.apply(null,arguments).map(wt);return new x(function(t,n){e.map(function(r){return x.resolve(r).then(t,n)})})},PSD:{get:function(){return k},set:function(e){return k=e}},totalEchoes:{get:function(){return _t}},newPSD:pe,usePSD:Ie,scheduler:{get:function(){return Ye},set:function(e){Ye=e}},rejectionMapper:{get:function(){return Xt},set:function(e){Xt=e}},follow:function(e,t){return new x(function(n,r){return pe(function(i,a){var o=k;o.unhandleds=[],o.onunhandled=a,o.finalize=Ee(function(){var u=this;si(function(){u.unhandleds.length===0?i():a(u.unhandleds[0])})},o.finalize),e()},t,n,r)})}});ct&&(ct.allSettled&&ue(x,"allSettled",function(){var e=ie.apply(null,arguments).map(wt);return new x(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return x.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--n||t(r)})})})}),ct.any&&typeof AggregateError<"u"&&ue(x,"any",function(){var e=ie.apply(null,arguments).map(wt);return new x(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,o){return x.resolve(a).then(function(u){return t(u)},function(u){i[o]=u,--r||n(new AggregateError(i))})})})}));function cr(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&et();n&&typeof n.then=="function"?cr(e,function(i,a){n instanceof x?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,fr(e)),r&&tt()}},Zt.bind(null,e))}catch(n){Zt(e,n)}}function Zt(e,t){if(ft.push(t),e._state===null){var n=e._lib&&et();t=Xt(t),e._state=!1,e._value=t,te&&t!==null&&typeof t=="object"&&!t._promise&&Ur(function(){var r=pn(t,"stack");t._promise=e,ue(t,"stack",{get:function(){return Qt?r&&(r.get?r.get.apply(t):r.value):e.stack}})}),li(e),fr(e),n&&tt()}}function fr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)wn(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),we===0&&(++we,Ye(function(){--we===0&&En()},[]))}function wn(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++we,Ye(ui,[n,e,t])}function ui(e,t,n){try{Jt=t;var r,i=t._value;t._state?r=e(i):(ft.length&&(ft=[]),r=e(i),ft.indexOf(i)===-1&&ci(t)),n.resolve(r)}catch(a){n.reject(a)}finally{Jt=null,--we===0&&En(),--n.psd.ref||n.psd.finalize()}}function hr(e,t,n){if(t.length===n)return t;var r="";if(e._state===!1){var i=e._value,a,o;i!=null?(a=i.name||"Error",o=i.message||i,r=qt(i,0)):(a=i,o=""),t.push(a+(o?": "+o:"")+r)}return te&&(r=qt(e._stackHolder,2),r&&t.indexOf(r)===-1&&t.push(r),e._prev&&hr(e._prev,t,n)),t}function dr(e,t){var n=t?t._numPrev+1:0;n<ii&&(e._prev=t,e._numPrev=n)}function at(){et()&&tt()}function et(){var e=Gt;return Gt=!1,bt=!1,e}function tt(){var e,t,n;do for(;Ve.length>0;)for(e=Ve,Ve=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(Ve.length>0);Gt=!0,bt=!0}function En(){var e=_e;_e=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=ht.slice(0),n=t.length;n;)t[--n]()}function si(e){function t(){e(),ht.splice(ht.indexOf(t),1)}ht.push(t),++we,Ye(function(){--we===0&&En()},[])}function li(e){_e.some(function(t){return t._value===e._value})||_e.push(e)}function ci(e){for(var t=_e.length;t;)if(_e[--t]._value===e._value){_e.splice(t,1);return}}function dt(e){return new x(He,!1,e)}function F(e,t){var n=k;return function(){var r=et(),i=k;try{return ve(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{ve(i,!1),r&&tt()}}}var V={awaits:0,echoes:0,id:0},fi=0,pt=[],Dt=0,_t=0,hi=0;function pe(e,t,n,r){var i=k,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++hi;var o=Te.env;a.env=_n?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:Pn(o.nthen,a),gthen:Pn(o.gthen,a)}:{},t&&z(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Ie(a,e,n,r);return a.ref===0&&a.finalize(),u}function Re(){return V.id||(V.id=++fi),++V.awaits,V.echoes+=ur,V.id}function se(){return V.awaits?(--V.awaits===0&&(V.id=0),V.echoes=V.awaits*ur,!0):!1}(""+sr).indexOf("[native code]")===-1&&(Re=se=P);function wt(e){return V.echoes&&e&&e.constructor===ct?(Re(),e.then(function(t){return se(),t},function(t){return se(),j(t)})):e}function di(e){++_t,(!V.echoes||--V.echoes===0)&&(V.echoes=V.id=0),pt.push(k),ve(e,!0)}function pi(){var e=pt[pt.length-1];pt.pop(),ve(e,!1)}function ve(e,t){var n=k;if((t?V.echoes&&(!Dt++||e!==k):Dt&&(!--Dt||e!==k))&&vr(t?di.bind(null,e):pi),e!==k&&(k=e,n===Te&&(Te.env=pr()),_n)){var r=Te.env.Promise,i=e.env;gt.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(M,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function pr(){var e=M.Promise;return _n?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(M,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:gt.then,gthen:e.prototype.then}:{}}function Ie(e,t,n,r,i){var a=k;try{return ve(e,!0),t(n,r,i)}finally{ve(a,!1)}}function vr(e){sr.call(Ht,e)}function Et(e,t,n,r){return typeof e!="function"?e:function(){var i=k;n&&Re(),ve(t,!0);try{return e.apply(this,arguments)}finally{ve(i,!1),r&&vr(se)}}}function Pn(e,t){return function(n,r){return e.call(this,Et(n,t),Et(r,t))}}var Mn="unhandledrejection";function Fn(e,t){var n;try{n=t.onuncatched(e)}catch{}if(n!==!1)try{var r,i={promise:t,reason:e};if(M.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Mn,!0,!0),z(r,i)):M.CustomEvent&&(r=new CustomEvent(Mn,{detail:i}),z(r,i)),r&&M.dispatchEvent&&(dispatchEvent(r),!M.PromiseRejectionEvent&&M.onunhandledrejection))try{M.onunhandledrejection(r)}catch{}te&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch{}}var j=x.reject;function en(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!k.letThrough&&!e._vip){if(e._state.openComplete)return j(new T.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return j(new T.DatabaseClosed);e.open().catch(P)}return e._state.dbReadyPromise.then(function(){return en(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===mn.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return en(e,t,n,r)})):j(a)}return i._promise(t,function(a,o){return pe(function(){return k.trans=i,r(a,o,i)})}).then(function(a){return i._completion.then(function(){return a})})}}var Nn="3.2.2",be=String.fromCharCode(65535),tn=-1/0,ne="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",yr="String expected.",We=[],Tt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),vi=Tt,yi=Tt,mr=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},Ct="__dbnames",Bt="readonly",Rt="readwrite";function Se(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var gr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ot(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=$e(t),delete t[e]),t}:function(t){return t}}var mi=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||k.trans,a=this.name;function o(s,l,d){if(!d.schema[a])throw new T.NotFound("Table "+a+" not part of transaction");return n(d.idbtrans,d)}var u=et();try{return i&&i.db===this.db?i===k.trans?i._promise(t,o,r):pe(function(){return i._promise(t,o,r)},{trans:i,transless:k.transless||k}):en(this.db,t,[this.name],o)}finally{u&&tt()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(U(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var n=N(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(d){return d.compound&&n.every(function(h){return d.keyPath.indexOf(h)>=0})&&d.keyPath.every(function(h){return n.indexOf(h)>=0})})[0];if(r&&this.db._maxKey!==be)return this.where(r.name).equals(r.keyPath.map(function(d){return t[d]}));!r&&te&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,a=this.db._deps.indexedDB;function o(d,h){try{return a.cmp(d,h)===0}catch{return!1}}var u=n.reduce(function(d,h){var p=d[0],m=d[1],f=i[h],c=t[h];return[p||f,p||!f?Se(m,f&&f.multi?function(v){var w=oe(v,h);return U(w)&&w.some(function(_){return o(c,_)})}:function(v){return o(c,oe(v,h))}):m]},[null,null]),s=u[0],l=u[1];return s?this.where(s.name).equals(t[s.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,U(t)?"["+t.join("+")+"]":t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){this.schema.mappedClass=t;var n=function(r){if(!r)return r;var i=Object.create(t.prototype);for(var a in r)if(H(r,a))try{i[a]=r[a]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},e.prototype.defineClass=function(){function t(n){z(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=ot(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{X(t,o,s)}catch{}return s})},e.prototype.update=function(t,n){if(typeof t=="object"&&!U(t)){var r=oe(t,this.schema.primKey.keyPath);if(r===void 0)return j(new T.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?N(n).forEach(function(i){X(t,i,n[i])}):n(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=ot(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{X(t,o,s)}catch{}return s})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?x.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:gr})}).then(function(n){return n.numFailures?x.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,d=s.keyPath;if(d&&a)throw new T.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var h=t.length,p=d&&l?t.map(ot(d)):t;return i.core.mutate({trans:u,type:"add",keys:a,values:p,wantResults:o}).then(function(m){var f=m.numFailures,c=m.results,v=m.lastResult,w=m.failures,_=o?c:v;if(f===0)return _;throw new Ue(i.name+".bulkAdd(): "+f+" of "+h+" operations failed",w)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,d=s.keyPath;if(d&&a)throw new T.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var h=t.length,p=d&&l?t.map(ot(d)):t;return i.core.mutate({trans:u,type:"put",keys:a,values:p,wantResults:o}).then(function(m){var f=m.numFailures,c=m.results,v=m.lastResult,w=m.failures,_=o?c:v;if(f===0)return _;throw new Ue(i.name+".bulkPut(): "+f+" of "+h+" operations failed",w)})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var a=i.numFailures,o=i.lastResult,u=i.failures;if(a===0)return o;throw new Ue(n.name+".bulkDelete(): "+a+" of "+r+" operations failed",u)})},e}();function nt(e){var t={},n=function(u,s){if(s){for(var l=arguments.length,d=new Array(l-1);--l;)d[l-1]=arguments[l];return t[u].subscribe.apply(null,d),e}else if(typeof u=="string")return t[u]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(u,s,l){if(typeof u=="object")return o(u);s||(s=ri),l||(l=P);var d={subscribers:[],fire:l,subscribe:function(h){d.subscribers.indexOf(h)===-1&&(d.subscribers.push(h),d.fire=s(d.fire,h))},unsubscribe:function(h){d.subscribers=d.subscribers.filter(function(p){return p!==h}),d.fire=d.subscribers.reduce(s,l)}};return t[u]=n[u]=d,d}function o(u){N(u).forEach(function(s){var l=u[s];if(U(l))a(s,u[s][0],u[s][1]);else if(l==="asap")var d=a(s,Ze,function(){for(var p=arguments.length,m=new Array(p);p--;)m[p]=arguments[p];d.subscribers.forEach(function(f){$n(function(){f.apply(null,m)})})});else throw new T.InvalidArgument("Invalid event config")})}}function rt(e,t){return De(t).from({prototype:e}),t}function gi(e){return rt(mi.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:nt(null,{creating:[ei,P],reading:[Zr,Ze],updating:[ni,P],deleting:[ti,P]})})}function Ae(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function It(e,t){e.filter=Se(e.filter,t)}function Pt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Se(r(),t())}:t,e.justLimit=n&&!r}function bi(e,t){e.isMatch=Se(e.isMatch,t)}function vt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new T.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function jn(e,t,n){var r=vt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function ut(e,t,n,r){var i=e.replayFilter?Se(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(u,s,l){if(!i||i(s,l,function(p){return s.stop(p)},function(p){return s.fail(p)})){var d=s.primaryKey,h=""+d;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(d)),H(a,h)||(a[h]=!0,t(u,s,l))}};return Promise.all([e.or._iterate(o,n),Ln(jn(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return Ln(jn(e,r,n),Se(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Ln(e,t,n,r){var i=r?function(o,u,s){return n(r(o),u,s)}:n,a=F(i);return e.then(function(o){if(o)return o.start(function(){var u=function(){return o.continue()};(!t||t(o,function(s){return u=s},function(s){o.stop(s),u=P},function(s){o.fail(s),u=P}))&&a(o.value,o,function(s){return u=s}),u()})})}function W(e,t){try{var n=Vn(e),r=Vn(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return wi(Un(e),Un(t));case"Array":return _i(e,t)}}catch{}return NaN}function _i(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=W(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function wi(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function Vn(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=Wt(e);return n==="ArrayBuffer"?"binary":n}function Un(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Ei=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,j.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,j.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=Se(n.algorithm,t)},e.prototype._iterate=function(t,n){return ut(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&z(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return ut(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ae(i,!0))return a.count({trans:r,query:{index:vt(i,a.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var o=0;return ut(i,function(){return++o,!1},r,a).then(function(){return o})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function o(l,d){return d?o(l[r[d]],d-1):l[i]}var u=this._ctx.dir==="next"?1:-1;function s(l,d){var h=o(l,a),p=o(d,a);return h<p?-u:h>p?u:0}return this.toArray(function(l){return l.sort(s)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ae(i,!0)&&i.limit>0){var a=i.valueMapper,o=vt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(s){var l=s.result;return a?l.map(a):l})}else{var u=[];return ut(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Ae(n)?Pt(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):Pt(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Pt(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return It(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return It(this._ctx,function(n){return t(n.value)}),bi(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Ae(n,!0)&&n.limit>0)return this._read(function(i){var a=vt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return It(this._ctx,function(i){var a=i.primaryKey.toString(),o=H(r,a);return r[a]=!0,!o}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof t=="function")a=t;else{var o=N(t),u=o.length;a=function(w){for(var _=!1,b=0;b<u;++b){var g=o[b],y=t[g];oe(w,g)!==y&&(X(w,g,y),_=!0)}return _}}var s=r.table.core,l=s.schema.primaryKey,d=l.outbound,h=l.extractKey,p=n.db._options.modifyChunkSize||200,m=[],f=0,c=[],v=function(w,_){var b=_.failures,g=_.numFailures;f+=w-g;for(var y=0,E=N(b);y<E.length;y++){var A=E[y];m.push(b[A])}};return n.clone().primaryKeys().then(function(w){var _=function(b){var g=Math.min(p,w.length-b);return s.getMany({trans:i,keys:w.slice(b,b+g),cache:"immutable"}).then(function(y){for(var E=[],A=[],S=d?[]:null,K=[],C=0;C<g;++C){var B=y[C],I={value:$e(B),primKey:w[b+C]};a.call(I,I.value,I)!==!1&&(I.value==null?K.push(w[b+C]):!d&&W(h(B),h(I.value))!==0?(K.push(w[b+C]),E.push(I.value)):(A.push(I.value),d&&S.push(w[b+C])))}var R=Ae(r)&&r.limit===1/0&&(typeof t!="function"||t===Mt)&&{index:r.index,range:r.range};return Promise.resolve(E.length>0&&s.mutate({trans:i,type:"add",values:E}).then(function(L){for(var O in L.failures)K.splice(parseInt(O),1);v(E.length,L)})).then(function(){return(A.length>0||R&&typeof t=="object")&&s.mutate({trans:i,type:"put",keys:S,values:A,criteria:R,changeSpec:typeof t!="function"&&t}).then(function(L){return v(A.length,L)})}).then(function(){return(K.length>0||R&&t===Mt)&&s.mutate({trans:i,type:"delete",keys:K,criteria:R}).then(function(L){return v(K.length,L)})}).then(function(){return w.length>b+g&&_(b+p)})})};return _(0).then(function(){if(m.length>0)throw new mt("Error modifying one or more objects",m,f,c);return w.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Ae(t)&&(t.isPrimKey&&!yi||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(u){var s=u.failures;u.lastResult,u.results;var l=u.numFailures;if(l)throw new mt("Could not delete some values",Object.keys(s).map(function(d){return s[d]}),o-l);return o-l})})}):this.modify(Mt)},e}(),Mt=function(e,t){return t.value=null};function Si(e){return rt(Ei.prototype,function(n,r){this.db=e;var i=gr,a=null;if(r)try{i=r()}catch(l){a=l}var o=n._ctx,u=o.table,s=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:s!==Ze?s:null}})}function xi(e,t){return e<t?-1:e===t?0:1}function Ai(e,t){return e>t?-1:e===t?0:1}function q(e,t,n){var r=e instanceof _r?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function ke(e){return new e.Collection(e,function(){return br("")}).limit(0)}function ki(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Ki(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Ti(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),u=-1,s=0;s<o;++s){var l=t[s];if(l!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[s],l)<0&&(u=s)}return o<r.length&&a==="next"?e+n.substr(e.length):o<e.length&&a==="prev"?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function st(e,t,n,r){var i,a,o,u,s,l,d,h=n.length;if(!n.every(function(c){return typeof c=="string"}))return q(e,yr);function p(c){i=ki(c),a=Ki(c),o=c==="next"?xi:Ai;var v=n.map(function(w){return{lower:a(w),upper:i(w)}}).sort(function(w,_){return o(w.lower,_.lower)});u=v.map(function(w){return w.upper}),s=v.map(function(w){return w.lower}),l=c,d=c==="next"?"":r}p("next");var m=new e.Collection(e,function(){return fe(u[0],s[h-1]+r)});m._ondirectionchange=function(c){p(c)};var f=0;return m._addAlgorithm(function(c,v,w){var _=c.key;if(typeof _!="string")return!1;var b=a(_);if(t(b,s,f))return!0;for(var g=null,y=f;y<h;++y){var E=Ti(_,b,u[y],s[y],o,l);E===null&&g===null?f=y+1:(g===null||o(g,E)>0)&&(g=E)}return v(g!==null?function(){c.continue(g+d)}:w),!1}),m}function fe(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function br(e){return{type:1,lower:e,upper:e}}var _r=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?ke(this):new this.Collection(this,function(){return fe(t,n,!r,!i)})}catch{return q(this,ne)}},e.prototype.equals=function(t){return t==null?q(this,ne):new this.Collection(this,function(){return br(t)})},e.prototype.above=function(t){return t==null?q(this,ne):new this.Collection(this,function(){return fe(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?q(this,ne):new this.Collection(this,function(){return fe(t,void 0,!1)})},e.prototype.below=function(t){return t==null?q(this,ne):new this.Collection(this,function(){return fe(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?q(this,ne):new this.Collection(this,function(){return fe(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?q(this,yr):this.between(t,t+be,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):st(this,function(n,r){return n.indexOf(r[0])===0},[t],be)},e.prototype.equalsIgnoreCase=function(t){return st(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=ie.apply(Ke,arguments);return t.length===0?ke(this):st(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=ie.apply(Ke,arguments);return t.length===0?ke(this):st(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,be)},e.prototype.anyOf=function(){var t=this,n=ie.apply(Ke,arguments),r=this._cmp;try{n.sort(r)}catch{return q(this,ne)}if(n.length===0)return ke(this);var i=new this.Collection(this,function(){return fe(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(o,u,s){for(var l=o.key;r(l,n[a])>0;)if(++a,a===n.length)return u(s),!1;return r(l,n[a])===0?!0:(u(function(){o.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[tn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=ie.apply(Ke,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return q(this,ne)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[tn,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,o=this._descending,u=this._min,s=this._max;if(t.length===0)return ke(this);if(!t.every(function(y){return y[0]!==void 0&&y[1]!==void 0&&a(y[0],y[1])<=0}))return q(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",T.InvalidArgument);var l=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0;function h(y,E){for(var A=0,S=y.length;A<S;++A){var K=y[A];if(i(E[0],K[1])<0&&i(E[1],K[0])>0){K[0]=u(K[0],E[0]),K[1]=s(K[1],E[1]);break}}return A===S&&y.push(E),y}var p=a;function m(y,E){return p(y[0],E[0])}var f;try{f=t.reduce(h,[]),f.sort(m)}catch{return q(this,ne)}var c=0,v=d?function(y){return a(y,f[c][1])>0}:function(y){return a(y,f[c][1])>=0},w=l?function(y){return o(y,f[c][0])>0}:function(y){return o(y,f[c][0])>=0};function _(y){return!v(y)&&!w(y)}var b=v,g=new this.Collection(this,function(){return fe(f[0][0],f[f.length-1][1],!l,!d)});return g._ondirectionchange=function(y){y==="next"?(b=v,p=a):(b=w,p=o),f.sort(m)},g._addAlgorithm(function(y,E,A){for(var S=y.key;b(S);)if(++c,c===f.length)return E(A),!1;return _(S)?!0:(r._cmp(S,f[c][1])===0||r._cmp(S,f[c][0])===0||E(function(){p===a?y.continue(f[c][0]):y.continue(f[c][1])}),!1)}),g},e.prototype.startsWithAnyOf=function(){var t=ie.apply(Ke,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?ke(this):this.inAnyRange(t.map(function(n){return[n,n+be]})):q(this,"startsWithAnyOf() only works with strings")},e}();function Ci(e){return rt(_r.prototype,function(n,r,i){this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i};var a=e._deps.indexedDB;if(!a)throw new T.MissingAPI;this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(o,u){return a.cmp(u,o)},this._max=function(o,u){return a.cmp(o,u)>0?o:u},this._min=function(o,u){return a.cmp(o,u)<0?o:u},this._IDBKeyRange=e._deps.IDBKeyRange})}function ee(e){return F(function(t){return Qe(t),e(t.target.error),!1})}function Qe(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ge="storagemutated",de="x-storagemutated-1",ye=nt(null,Ge),Oi=function(){function e(){}return e.prototype._lock=function(){return Le(!k.global),++this._reculock,this._reculock===1&&!k.global&&(k.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Le(!k.global),--this._reculock===0)for(k.global||(k.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Ie(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&k.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Le(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new T.DatabaseClosed(i);case"MissingAPIError":throw new T.MissingAPI(i.message,i);default:throw new T.OpenFailed(i)}if(!this.active)throw new T.TransactionInactive;return Le(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=F(function(a){Qe(a),n._reject(t.error)}),t.onabort=F(function(a){Qe(a),n.active&&n._reject(new T.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=F(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&ye.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return j(new T.ReadOnly("Transaction is readonly"));if(!this.active)return j(new T.TransactionInactive);if(this._locked())return new x(function(o,u){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,u)},k])});if(r)return pe(function(){var o=new x(function(u,s){i._lock();var l=n(u,s,i);l&&l.then&&l.then(u,s)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new x(function(o,u){var s=n(o,u,i);s&&s.then&&s.then(o,u)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=x.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new x(function(o,u){r.then(function(s){return n._waitingQueue.push(F(o.bind(null,s)))},function(s){return n._waitingQueue.push(F(u.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new T.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(H(n,t))return n[t];var r=this.schema[t];if(!r)throw new T.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function Di(e){return rt(Oi.prototype,function(n,r,i,a,o){var u=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=nt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x(function(s,l){u._resolve=s,u._reject=l}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var l=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):l&&u.idbtrans&&u.idbtrans.abort(),j(s)})})}function nn(e,t,n,r,i,a,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+wr(t)}}function wr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Er(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Zn(n,function(r){return[r.name,r]})}}function Bi(e){return e.length===1?e[0]:e}var Je=function(e){try{return e.only([[]]),Je=function(){return[[]]},[[]]}catch{return Je=function(){return be},be}};function rn(e){return e==null?function(){}:typeof e=="string"?Ri(e):function(t){return oe(t,e)}}function Ri(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return oe(n,e)}}function Wn(e){return[].slice.call(e)}var Ii=0;function ze(e){return e==null?":id":typeof e=="string"?e:"["+e.join("+")+"]"}function Pi(e,t,n){function r(h,p){var m=Wn(h.objectStoreNames);return{schema:{name:h.name,tables:m.map(function(f){return p.objectStore(f)}).map(function(f){var c=f.keyPath,v=f.autoIncrement,w=U(c),_=c==null,b={},g={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_,compound:w,keyPath:c,autoIncrement:v,unique:!0,extractKey:rn(c)},indexes:Wn(f.indexNames).map(function(y){return f.index(y)}).map(function(y){var E=y.name,A=y.unique,S=y.multiEntry,K=y.keyPath,C=U(K),B={name:E,compound:C,keyPath:K,unique:A,multiEntry:S,extractKey:rn(K)};return b[ze(K)]=B,B}),getIndexByKeyPath:function(y){return b[ze(y)]}};return b[":id"]=g.primaryKey,c!=null&&(b[ze(c)]=g.primaryKey),g})},hasGetAll:m.length>0&&"getAll"in p.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(h){if(h.type===3)return null;if(h.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var p=h.lower,m=h.upper,f=h.lowerOpen,c=h.upperOpen,v=p===void 0?m===void 0?null:t.upperBound(m,!!c):m===void 0?t.lowerBound(p,!!f):t.bound(p,m,!!f,!!c);return v}function a(h){var p=h.name;function m(v){var w=v.trans,_=v.type,b=v.keys,g=v.values,y=v.range;return new Promise(function(E,A){E=F(E);var S=w.objectStore(p),K=S.keyPath==null,C=_==="put"||_==="add";if(!C&&_!=="delete"&&_!=="deleteRange")throw new Error("Invalid operation type: "+_);var B=(b||g||{length:1}).length;if(b&&g&&b.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(B===0)return E({numFailures:0,failures:{},results:[],lastResult:void 0});var I,R=[],L=[],O=0,Y=function(Z){++O,Qe(Z)};if(_==="deleteRange"){if(y.type===4)return E({numFailures:O,failures:L,results:[],lastResult:void 0});y.type===3?R.push(I=S.clear()):R.push(I=S.delete(i(y)))}else{var G=C?K?[g,b]:[g,null]:[b,null],le=G[0],$=G[1];if(C)for(var Q=0;Q<B;++Q)R.push(I=$&&$[Q]!==void 0?S[_](le[Q],$[Q]):S[_](le[Q])),I.onerror=Y;else for(var Q=0;Q<B;++Q)R.push(I=S[_](le[Q])),I.onerror=Y}var ce=function(Z){var Me=Z.target.result;R.forEach(function(J,it){return J.error!=null&&(L[it]=J.error)}),E({numFailures:O,failures:L,results:_==="delete"?b:R.map(function(J){return J.result}),lastResult:Me})};I.onerror=function(Z){Y(Z),ce(Z)},I.onsuccess=ce})}function f(v){var w=v.trans,_=v.values,b=v.query,g=v.reverse,y=v.unique;return new Promise(function(E,A){E=F(E);var S=b.index,K=b.range,C=w.objectStore(p),B=S.isPrimaryKey?C:C.index(S.name),I=g?y?"prevunique":"prev":y?"nextunique":"next",R=_||!("openKeyCursor"in B)?B.openCursor(i(K),I):B.openKeyCursor(i(K),I);R.onerror=ee(A),R.onsuccess=F(function(L){var O=R.result;if(!O){E(null);return}O.___id=++Ii,O.done=!1;var Y=O.continue.bind(O),G=O.continuePrimaryKey;G&&(G=G.bind(O));var le=O.advance.bind(O),$=function(){throw new Error("Cursor not started")},Q=function(){throw new Error("Cursor not stopped")};O.trans=w,O.stop=O.continue=O.continuePrimaryKey=O.advance=$,O.fail=F(A),O.next=function(){var ce=this,Z=1;return this.start(function(){return Z--?ce.continue():ce.stop()}).then(function(){return ce})},O.start=function(ce){var Z=new Promise(function(J,it){J=F(J),R.onerror=ee(it),O.fail=it,O.stop=function(Rr){O.stop=O.continue=O.continuePrimaryKey=O.advance=Q,J(Rr)}}),Me=function(){if(R.result)try{ce()}catch(J){O.fail(J)}else O.done=!0,O.start=function(){throw new Error("Cursor behind last entry")},O.stop()};return R.onsuccess=F(function(J){R.onsuccess=Me,Me()}),O.continue=Y,O.continuePrimaryKey=G,O.advance=le,Me(),Z},E(O)},A)})}function c(v){return function(w){return new Promise(function(_,b){_=F(_);var g=w.trans,y=w.values,E=w.limit,A=w.query,S=E===1/0?void 0:E,K=A.index,C=A.range,B=g.objectStore(p),I=K.isPrimaryKey?B:B.index(K.name),R=i(C);if(E===0)return _({result:[]});if(v){var L=y?I.getAll(R,S):I.getAllKeys(R,S);L.onsuccess=function(le){return _({result:le.target.result})},L.onerror=ee(b)}else{var O=0,Y=y||!("openKeyCursor"in I)?I.openCursor(R):I.openKeyCursor(R),G=[];Y.onsuccess=function(le){var $=Y.result;if(!$)return _({result:G});if(G.push(y?$.value:$.primaryKey),++O===E)return _({result:G});$.continue()},Y.onerror=ee(b)}})}}return{name:p,schema:h,mutate:m,getMany:function(v){var w=v.trans,_=v.keys;return new Promise(function(b,g){b=F(b);for(var y=w.objectStore(p),E=_.length,A=new Array(E),S=0,K=0,C,B=function(O){var Y=O.target;(A[Y._pos]=Y.result)!=null,++K===S&&b(A)},I=ee(g),R=0;R<E;++R){var L=_[R];L!=null&&(C=y.get(_[R]),C._pos=R,C.onsuccess=B,C.onerror=I,++S)}S===0&&b(A)})},get:function(v){var w=v.trans,_=v.key;return new Promise(function(b,g){b=F(b);var y=w.objectStore(p),E=y.get(_);E.onsuccess=function(A){return b(A.target.result)},E.onerror=ee(g)})},query:c(s),openCursor:f,count:function(v){var w=v.query,_=v.trans,b=w.index,g=w.range;return new Promise(function(y,E){var A=_.objectStore(p),S=b.isPrimaryKey?A:A.index(b.name),K=i(g),C=K?S.count(K):S.count();C.onsuccess=F(function(B){return y(B.target.result)}),C.onerror=ee(E)})}}}var o=r(e,n),u=o.schema,s=o.hasGetAll,l=u.tables.map(function(h){return a(h)}),d={};return l.forEach(function(h){return d[h.name]=h}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(h){var p=d[h];if(!p)throw new Error("Table '"+h+"' not found");return d[h]},MIN_KEY:-1/0,MAX_KEY:Je(t),schema:u}}function Mi(e,t){return t.reduce(function(n,r){var i=r.create;return D(D({},n),i(n))},e)}function Fi(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=Mi(Pi(t,i,r),e.dbcore);return{dbcore:a}}function Sn(e,t){var n=e._novip,r=t.db,i=Fi(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach(function(a){var o=a.name;n.core.schema.tables.some(function(u){return u.name===o})&&(a.core=n.core.table(o),n[o]instanceof n.Table&&(n[o].core=a.core))})}function St(e,t,n,r){var i=e._novip;n.forEach(function(a){var o=r[a];t.forEach(function(u){var s=pn(u,a);(!s||"value"in s&&s.value===void 0)&&(u===i.Transaction.prototype||u instanceof i.Transaction?ue(u,a,{get:function(){return this.table(a)},set:function(l){Jn(this,a,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):u[a]=new i.Table(a,o))})})}function an(e,t){var n=e._novip;t.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Ni(e,t){return e._cfg.version-t._cfg.version}function ji(e,t,n,r){var i=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var o=a._reject.bind(a),u=k.transless||k;pe(function(){k.trans=a,k.transless=u,t===0?(N(i).forEach(function(s){xn(n,s,i[s].primKey,i[s].indexes)}),Sn(e,n),x.follow(function(){return e.on.populate.fire(a)}).catch(o)):Li(e,t,a,n).catch(o)})}function Li(e,t,n,r){var i=e._novip,a=[],o=i._versions,u=i._dbSchema=An(i,i.idbdb,r),s=!1,l=o.filter(function(h){return h._cfg.version>=t});l.forEach(function(h){a.push(function(){var p=u,m=h._cfg.dbschema;un(i,p,r),un(i,m,r),u=i._dbSchema=m;var f=Sr(p,m);f.add.forEach(function(g){xn(r,g[0],g[1].primKey,g[1].indexes)}),f.change.forEach(function(g){if(g.recreate)throw new T.Upgrade("Not yet support for changing primary key");var y=r.objectStore(g.name);g.add.forEach(function(E){return on(y,E)}),g.change.forEach(function(E){y.deleteIndex(E.name),on(y,E)}),g.del.forEach(function(E){return y.deleteIndex(E)})});var c=h._cfg.contentUpgrade;if(c&&h._cfg.version>t){Sn(i,r),n._memoizedTables={},s=!0;var v=er(m);f.del.forEach(function(g){v[g]=p[g]}),an(i,[i.Transaction.prototype]),St(i,[i.Transaction.prototype],N(v),v),n.schema=v;var w=vn(c);w&&Re();var _,b=x.follow(function(){if(_=c(n),_&&w){var g=se.bind(null,null);_.then(g,g)}});return _&&typeof _.then=="function"?x.resolve(_):b.then(function(){return _})}}),a.push(function(p){if(!s||!vi){var m=h._cfg.dbschema;Ui(m,p)}an(i,[i.Transaction.prototype]),St(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function d(){return a.length?x.resolve(a.shift()(n.idbtrans)).then(d):x.resolve()}return d().then(function(){Vi(u,r)})}function Sr(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!Tt)o.recreate=!0,n.change.push(o);else{var u=i.idxByName,s=a.idxByName,l=void 0;for(l in u)s[l]||o.del.push(l);for(l in s){var d=u[l],h=s[l];d?d.src!==h.src&&o.change.push(h):o.add.push(h)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function xn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return on(i,a)}),i}function Vi(e,t){N(e).forEach(function(n){t.db.objectStoreNames.contains(n)||xn(t,n,e[n].primKey,e[n].indexes)})}function Ui(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function on(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function An(e,t,n){var r={},i=kt(t.objectStoreNames,0);return i.forEach(function(a){for(var o=n.objectStore(a),u=o.keyPath,s=nn(wr(u),u||"",!1,!1,!!o.autoIncrement,u&&typeof u!="string",!0),l=[],d=0;d<o.indexNames.length;++d){var h=o.index(o.indexNames[d]);u=h.keyPath;var p=nn(h.name,u,!!h.unique,!!h.multiEntry,!1,u&&typeof u!="string",!1);l.push(p)}r[a]=Er(a,s,l)}),r}function Wi(e,t,n){var r=e._novip;r.verno=t.version/10;var i=r._dbSchema=An(r,t,n);r._storeNames=kt(t.objectStoreNames,0),St(r,[r._allTables],N(i),i)}function zi(e,t){var n=An(e,e.idbdb,t),r=Sr(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function un(e,t,n){for(var r=e._novip,i=n.db.objectStoreNames,a=0;a<i.length;++a){var o=i[a],u=n.objectStore(o);r._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var l=u.indexNames[s],d=u.index(l).keyPath,h=typeof d=="string"?d:"["+kt(d).join("+")+"]";if(t[o]){var p=t[o].idxByName[h];p&&(p.name=l,delete t[o].idxByName[h],t[o].idxByName[l]=p)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&M.WorkerGlobalScope&&M instanceof M.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function qi(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return nn(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),U(i),n===0)})}var Hi=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){N(t).forEach(function(r){if(t[r]!==null){var i=qi(t[r]),a=i.shift();if(a.multi)throw new T.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new T.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new T.Schema("Index must have a name and cannot be an empty string")}),n[r]=Er(r,a,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?z(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(o){z(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),n._dbSchema=a,an(n,[n._allTables,n,n.Transaction.prototype]),St(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],N(a),a),n._storeNames=N(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=gn(this._cfg.contentUpgrade||P,t),this},e}();function Yi(e){return rt(Hi.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function kn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new On(Ct,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Kn(e){return e&&typeof e.databases=="function"}function Qi(e){var t=e.indexedDB,n=e.IDBKeyRange;return Kn(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Ct})}):kn(t,n).toCollection().primaryKeys()}function Gi(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Kn(n)&&t!==Ct&&kn(n,r).put({name:t}).catch(P)}function Ji(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Kn(n)&&t!==Ct&&kn(n,r).delete(t).catch(P)}function sn(e){return pe(function(){return k.letThrough=!0,e()})}function Xi(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}function $i(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?j(t.dbOpenError):e});te&&(t.openCanceller._stackHolder=xe()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new T.DatabaseClosed("db.open() was cancelled")}var a=t.dbReadyResolve,o=null,u=!1;return x.race([r,(typeof navigator>"u"?x.resolve():Xi()).then(function(){return new x(function(s,l){if(i(),!n)throw new T.MissingAPI;var d=e.name,h=t.autoSchema?n.open(d):n.open(d,Math.round(e.verno*10));if(!h)throw new T.MissingAPI;h.onerror=ee(l),h.onblocked=F(e._fireOnBlocked),h.onupgradeneeded=F(function(p){if(o=h.transaction,t.autoSchema&&!e._options.allowEmptyDB){h.onerror=Qe,o.abort(),h.result.close();var m=n.deleteDatabase(d);m.onsuccess=m.onerror=F(function(){l(new T.NoSuchDatabase("Database "+d+" doesnt exist"))})}else{o.onerror=ee(l);var f=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;u=f<1,e._novip.idbdb=h.result,ji(e,f/10,o,l)}},l),h.onsuccess=F(function(){o=null;var p=e._novip.idbdb=h.result,m=kt(p.objectStoreNames);if(m.length>0)try{var f=p.transaction(Bi(m),"readonly");t.autoSchema?Wi(e,p,f):(un(e,e._dbSchema,f),zi(e,f)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Sn(e,f)}catch{}We.push(e),p.onversionchange=F(function(c){t.vcFired=!0,e.on("versionchange").fire(c)}),p.onclose=F(function(c){e.on("close").fire(c)}),u&&Gi(e._deps,d),s()},l)})})]).then(function(){return i(),t.onReadyBeingFired=[],x.resolve(sn(function(){return e.on.ready.fire(e.vip)})).then(function s(){if(t.onReadyBeingFired.length>0){var l=t.onReadyBeingFired.reduce(gn,P);return t.onReadyBeingFired=[],x.resolve(sn(function(){return l(e.vip)})).then(s)}})}).finally(function(){t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(function(){return e}).catch(function(s){t.dbOpenError=s;try{o&&o.abort()}catch{}return r===t.openCanceller&&e._close(),j(s)}).finally(function(){t.openComplete=!0,a()})}function ln(e){var t=function(o){return e.next(o)},n=function(o){return e.throw(o)},r=a(t),i=a(n);function a(o){return function(u){var s=o(u),l=s.value;return s.done?l:!l||typeof l.then!="function"?U(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return a(t)()}function Zi(e,t,n){var r=arguments.length;if(r<2)throw new T.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=tr(i);return[e,a,n]}function xr(e,t,n,r,i){return x.resolve().then(function(){var a=k.transless||k,o=e._createTransaction(t,n,e._dbSchema,r),u={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(h){return h.name===mn.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return xr(e,t,n,null,i)})):j(h)}var s=vn(i);s&&Re();var l,d=x.follow(function(){if(l=i.call(o,o),l)if(s){var h=se.bind(null,null);l.then(h,h)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=ln(l))},u);return(l&&typeof l.then=="function"?x.resolve(l).then(function(h){return o.active?h:j(new T.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):d.then(function(){return l})).then(function(h){return r&&o._resolve(),o._completion.then(function(){return h})}).catch(function(h){return o._reject(h),j(h)})})}function lt(e,t,n){for(var r=U(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function ea(e){return D(D({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function o(c,v,w){var _=ze(c),b=i[_]=i[_]||[],g=c==null?0:typeof c=="string"?1:c.length,y=v>0,E=D(D({},w),{isVirtual:y,keyTail:v,keyLength:g,extractKey:rn(c),unique:!y&&w.unique});if(b.push(E),E.isPrimaryKey||a.push(E),g>1){var A=g===2?c[0]:c.slice(0,g-1);o(A,v+1,w)}return b.sort(function(S,K){return S.keyTail-K.keyTail}),E}var u=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,l=r.indexes;s<l.length;s++){var d=l[s];o(d.keyPath,0,d)}function h(c){var v=i[ze(c)];return v&&v[0]}function p(c,v){return{type:c.type===1?2:c.type,lower:lt(c.lower,c.lowerOpen?e.MAX_KEY:e.MIN_KEY,v),lowerOpen:!0,upper:lt(c.upper,c.upperOpen?e.MIN_KEY:e.MAX_KEY,v),upperOpen:!0}}function m(c){var v=c.query.index;return v.isVirtual?D(D({},c),{query:{index:v,range:p(c.query.range,v.keyTail)}}):c}var f=D(D({},n),{schema:D(D({},r),{primaryKey:u,indexes:a,getIndexByKeyPath:h}),count:function(c){return n.count(m(c))},query:function(c){return n.query(m(c))},openCursor:function(c){var v=c.query.index,w=v.keyTail,_=v.isVirtual,b=v.keyLength;if(!_)return n.openCursor(c);function g(y){function E(S){S!=null?y.continue(lt(S,c.reverse?e.MAX_KEY:e.MIN_KEY,w)):c.unique?y.continue(y.key.slice(0,b).concat(c.reverse?e.MIN_KEY:e.MAX_KEY,w)):y.continue()}var A=Object.create(y,{continue:{value:E},continuePrimaryKey:{value:function(S,K){y.continuePrimaryKey(lt(S,e.MAX_KEY,w),K)}},primaryKey:{get:function(){return y.primaryKey}},key:{get:function(){var S=y.key;return b===1?S[0]:S.slice(0,b)}},value:{get:function(){return y.value}}});return A}return n.openCursor(m(c)).then(function(y){return y&&g(y)})}});return f}})}var ta={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ea};function Tn(e,t,n,r){return n=n||{},r=r||"",N(e).forEach(function(i){if(!H(t,i))n[r+i]=void 0;else{var a=e[i],o=t[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var u=Wt(a),s=Wt(o);u!==s?n[r+i]=t[i]:u==="Object"?Tn(a,o,n,r+i+"."):a!==o&&(n[r+i]=t[i])}else a!==o&&(n[r+i]=t[i])}}),N(t).forEach(function(i){H(e,i)||(n[r+i]=t[i])}),n}function na(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var ra={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return D(D({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=D(D({},n),{mutate:function(a){var o=k.trans,u=o.table(t).hook,s=u.deleting,l=u.creating,d=u.updating;switch(a.type){case"add":if(l.fire===P)break;return o._promise("readwrite",function(){return h(a)},!0);case"put":if(l.fire===P&&d.fire===P)break;return o._promise("readwrite",function(){return h(a)},!0);case"delete":if(s.fire===P)break;return o._promise("readwrite",function(){return h(a)},!0);case"deleteRange":if(s.fire===P)break;return o._promise("readwrite",function(){return p(a)},!0)}return n.mutate(a);function h(f){var c=k.trans,v=f.keys||na(r,f);if(!v)throw new Error("Keys missing");return f=f.type==="add"||f.type==="put"?D(D({},f),{keys:v}):D({},f),f.type!=="delete"&&(f.values=Vt([],f.values,!0)),f.keys&&(f.keys=Vt([],f.keys,!0)),ia(n,f,v).then(function(w){var _=v.map(function(b,g){var y=w[g],E={onerror:null,onsuccess:null};if(f.type==="delete")s.fire.call(E,b,y,c);else if(f.type==="add"||y===void 0){var A=l.fire.call(E,b,f.values[g],c);b==null&&A!=null&&(b=A,f.keys[g]=b,r.outbound||X(f.values[g],r.keyPath,b))}else{var S=Tn(y,f.values[g]),K=d.fire.call(E,S,b,y,c);if(K){var C=f.values[g];Object.keys(K).forEach(function(B){H(C,B)?C[B]=K[B]:X(C,B,K[B])})}}return E});return n.mutate(f).then(function(b){for(var g=b.failures,y=b.results,E=b.numFailures,A=b.lastResult,S=0;S<v.length;++S){var K=y?y[S]:v[S],C=_[S];K==null?C.onerror&&C.onerror(g[S]):C.onsuccess&&C.onsuccess(f.type==="put"&&w[S]?f.values[S]:K)}return{failures:g,results:y,numFailures:E,lastResult:A}}).catch(function(b){return _.forEach(function(g){return g.onerror&&g.onerror(b)}),Promise.reject(b)})})}function p(f){return m(f.trans,f.range,1e4)}function m(f,c,v){return n.query({trans:f,values:!1,query:{index:r,range:c},limit:v}).then(function(w){var _=w.result;return h({type:"delete",keys:_,trans:f}).then(function(b){return b.numFailures>0?Promise.reject(b.failures[0]):_.length<v?{failures:[],numFailures:0,lastResult:void 0}:m(f,D(D({},c),{lower:_[_.length-1],lowerOpen:!0}),v)})})}}});return i}})}};function ia(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Ar(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)W(t.keys[i],e[a])===0&&(r.push(n?$e(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var aa={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return D(D({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Ar(r.keys,r.trans._cache,r.cache==="clone");return i?x.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?$e(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Ft;function Cn(e){return!("from"in e)}var re=function(e,t){if(this)z(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new re;return e&&"d"in e&&z(n,e),n}};Oe(re.prototype,(Ft={add:function(e){return xt(this,e),this},addKey:function(e){return Xe(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Xe(t,n,n)}),this}},Ft[zt]=function(){return cn(this)},Ft));function Xe(e,t,n){var r=W(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Cn(e))return z(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(W(n,e.from)<0)return i?Xe(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},zn(e);if(W(t,e.to)>0)return a?Xe(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},zn(e);W(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),W(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&xt(e,i),a&&o&&xt(e,a)}}function xt(e,t){function n(r,i){var a=i.from,o=i.to,u=i.l,s=i.r;Xe(r,a,o),u&&n(r,u),s&&n(r,s)}Cn(t)||n(e,t)}function oa(e,t){var n=cn(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=cn(e),o=a.next(i.from),u=o.value;!r.done&&!o.done;){if(W(u.from,i.to)<=0&&W(u.to,i.from)>=0)return!0;W(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(o=a.next(i.from)).value}return!1}function cn(e){var t=Cn(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&W(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||W(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function zn(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=D({},e),u=e[i];e.from=u.from,e.to=u.to,e[i]=u[i],o[i]=u[a],e[a]=o,o.d=qn(o)}e.d=qn(e)}function qn(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}var ua={stack:"dbcore",level:0,create:function(e){var t=e.schema.name,n=new re(e.MIN_KEY,e.MAX_KEY);return D(D({},e),{table:function(r){var i=e.table(r),a=i.schema,o=a.primaryKey,u=o.extractKey,s=o.outbound,l=D(D({},i),{mutate:function(p){var m=p.trans,f=m.mutatedParts||(m.mutatedParts={}),c=function(A){var S="idb://"+t+"/"+r+"/"+A;return f[S]||(f[S]=new re)},v=c(""),w=c(":dels"),_=p.type,b=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[],g=b[0],y=b[1],E=p.trans._cache;return i.mutate(p).then(function(A){if(U(g)){_!=="delete"&&(g=A.results),v.addKeys(g);var S=Ar(g,E);!S&&_!=="add"&&w.addKeys(g),(S||y)&&sa(c,a,S,y)}else if(g){var K={from:g.lower,to:g.upper};w.add(K),v.add(K)}else v.add(n),w.add(n),a.indexes.forEach(function(C){return c(C.name).add(n)});return A})}}),d=function(p){var m,f,c=p.query,v=c.index,w=c.range;return[v,new re((m=w.lower)!==null&&m!==void 0?m:e.MIN_KEY,(f=w.upper)!==null&&f!==void 0?f:e.MAX_KEY)]},h={get:function(p){return[o,new re(p.key)]},getMany:function(p){return[o,new re().addKeys(p.keys)]},count:d,query:d,openCursor:d};return N(h).forEach(function(p){l[p]=function(m){var f=k.subscr;if(f){var c=function(E){var A="idb://"+t+"/"+r+"/"+E;return f[A]||(f[A]=new re)},v=c(""),w=c(":dels"),_=h[p](m),b=_[0],g=_[1];if(c(b.name||"").add(g),!b.isPrimaryKey)if(p==="count")w.add(n);else{var y=p==="query"&&s&&m.values&&i.query(D(D({},m),{values:!1}));return i[p].apply(this,arguments).then(function(E){if(p==="query"){if(s&&m.values)return y.then(function(C){var B=C.result;return v.addKeys(B),E});var A=m.values?E.result.map(u):E.result;m.values?v.addKeys(A):w.addKeys(A)}else if(p==="openCursor"){var S=E,K=m.values;return S&&Object.create(S,{key:{get:function(){return w.addKey(S.primaryKey),S.key}},primaryKey:{get:function(){var C=S.primaryKey;return w.addKey(C),C}},value:{get:function(){return K&&v.addKey(S.primaryKey),S.value}}})}return E})}}return i[p].apply(this,arguments)}}),l}})}};function sa(e,t,n,r){function i(a){var o=e(a.name||"");function u(l){return l!=null?a.extractKey(l):null}var s=function(l){return a.multiEntry&&U(l)?l.forEach(function(d){return o.addKey(d)}):o.addKey(l)};(n||r).forEach(function(l,d){var h=n&&u(n[d]),p=r&&u(r[d]);W(h,p)!==0&&(h!=null&&s(h),p!=null&&s(p))})}t.indexes.forEach(i)}var On=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=D({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:P,dbReadyPromise:null,cancelOpen:P,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new x(function(u){o.dbReadyResolve=u}),o.openCanceller=new x(function(u,s){o.cancelOpen=s}),this._state=o,this.name=t,this.on=nt(this,"populate","blocked","versionchange","close",{ready:[gn,P]}),this.on.ready.subscribe=Xn(this.on.ready.subscribe,function(u){return function(s,l){e.vip(function(){var d=r._state;if(d.openComplete)d.dbOpenError||x.resolve().then(s),l&&u(s);else if(d.onReadyBeingFired)d.onReadyBeingFired.push(s),l&&u(s);else{u(s);var h=r;l||u(function p(){h.on.ready.unsubscribe(s),h.on.ready.unsubscribe(p)})}})}}),this.Collection=Si(this),this.Table=gi(this),this.Transaction=Di(this),this.Version=Yi(this),this.WhereClause=Ci(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+u.oldVersion/10)}),this._maxKey=Je(n.IDBKeyRange),this._createTransaction=function(u,s,l,d){return new r.Transaction(u,s,l,r._options.chromeTransactionDurability,d)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),We.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(u)})},this.use(ta),this.use(ra),this.use(ua),this.use(aa),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(function(u){return u(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new T.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new T.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(Ni),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||k.letThrough||this._vip)?t():new x(function(r,i){if(n._state.openComplete)return i(new T.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new T.DatabaseClosed);return}n.open().catch(P)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i??10,name:a}),o.sort(function(u,s){return u.level-s.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){return $i(this)},e.prototype._close=function(){var t=this._state,n=We.indexOf(this);if(n>=0&&We.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new x(function(r){t.dbReadyResolve=r}),t.openCanceller=new x(function(r,i){t.cancelOpen=i})},e.prototype.close=function(){this._close();var t=this._state;this._options.autoOpen=!1,t.dbOpenError=new T.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)},e.prototype.delete=function(){var t=this,n=arguments.length>0,r=this._state;return new x(function(i,a){var o=function(){t.close();var u=t._deps.indexedDB.deleteDatabase(t.name);u.onsuccess=F(function(){Ji(t._deps,t.name),i()}),u.onerror=ee(a),u.onblocked=t._fireOnBlocked};if(n)throw new T.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return N(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Zi.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=k.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var o=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(d){var h=d instanceof i.Table?d.name:d;if(typeof h!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return h}),t=="r"||t===Bt)u=Bt;else if(t=="rw"||t==Rt)u=Rt;else throw new T.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===Bt&&u===Rt)if(o)a=null;else throw new T.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(d){if(a&&a.storeNames.indexOf(d)===-1)if(o)a=null;else throw new T.SubTransaction("Table "+d+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(d){return a?a._promise(null,function(h,p){p(d)}):j(d)}var l=xr.bind(null,this,u,s,a,r);return a?a._promise(u,l,"lock"):k.trans?Ie(k.transless,function(){return i._whenReady(l)}):this._whenReady(l)},e.prototype.table=function(t){if(!H(this._allTables,t))throw new T.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},e}(),la=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ca=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[la]=function(){return this},e}();function kr(e,t){return N(t).forEach(function(n){var r=e[n]||(e[n]=new re);xt(r,t[n])}),e}function fa(e){return new ca(function(t){var n=vn(e);function r(m){n&&Re();var f=function(){return pe(e,{subscr:m,trans:null})},c=k.trans?Ie(k.transless,f):f();return n&&c.then(se,se),c}var i=!1,a={},o={},u={get closed(){return i},unsubscribe:function(){i=!0,ye.storagemutated.unsubscribe(h)}};t.start&&t.start(u);var s=!1,l=!1;function d(){return N(o).some(function(m){return a[m]&&oa(a[m],o[m])})}var h=function(m){kr(a,m),d()&&p()},p=function(){if(!(s||i)){a={};var m={},f=r(m);l||(ye(Ge,h),l=!0),s=!0,Promise.resolve(f).then(function(c){s=!1,!i&&(d()?p():(a={},o=m,t.next&&t.next(c)))},function(c){s=!1,t.error&&t.error(c),u.unsubscribe()})}};return p(),u})}var fn;try{fn={indexedDB:M.indexedDB||M.mozIndexedDB||M.webkitIndexedDB||M.msIndexedDB,IDBKeyRange:M.IDBKeyRange||M.webkitIDBKeyRange}}catch{fn={indexedDB:null,IDBKeyRange:null}}var me=On;Oe(me,D(D({},Kt),{delete:function(e){var t=new me(e,{addons:[]});return t.delete()},exists:function(e){return new me(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Qi(me.dependencies).then(e)}catch{return j(new T.MissingAPI)}},defineClass:function(){function e(t){z(this,t)}return e},ignoreTransaction:function(e){return k.trans?Ie(k.transless,e):e()},vip:sn,async:function(e){return function(){try{var t=ln(e.apply(this,arguments));return!t||typeof t.then!="function"?x.resolve(t):t}catch(n){return j(n)}}},spawn:function(e,t,n){try{var r=ln(e.apply(n,t||[]));return!r||typeof r.then!="function"?x.resolve(r):r}catch(i){return j(i)}},currentTransaction:{get:function(){return k.trans||null}},waitFor:function(e,t){var n=x.resolve(typeof e=="function"?me.ignoreTransaction(e):e).timeout(t||6e4);return k.trans?k.trans.waitFor(n):n},Promise:x,debug:{get:function(){return te},set:function(e){rr(e,e==="dexie"?function(){return!0}:mr)}},derive:De,extend:z,props:Oe,override:Xn,Events:nt,on:ye,liveQuery:fa,extendObservabilitySet:kr,getByKeyPath:oe,setByKeyPath:X,delByKeyPath:Wr,shallowClone:er,deepClone:$e,getObjectDiff:Tn,cmp:W,asap:$n,minKey:tn,addons:[],connections:We,errnames:mn,dependencies:fn,semVer:Nn,version:Nn.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})}));me.maxKey=Je(me.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ye(Ge,function(e){if(!ae){var t;Tt?(t=document.createEvent("CustomEvent"),t.initCustomEvent(de,!0,!0,e)):t=new CustomEvent(de,{detail:e}),ae=!0,dispatchEvent(t),ae=!1}}),addEventListener(de,function(e){var t=e.detail;ae||At(t)}));function At(e){var t=ae;try{ae=!0,ye.storagemutated.fire(e)}finally{ae=t}}var ae=!1;if(typeof BroadcastChannel<"u"){var Hn=new BroadcastChannel(de);ye(Ge,function(e){ae||Hn.postMessage(e)}),Hn.onmessage=function(e){e.data&&At(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ye(Ge,function(e){try{ae||(typeof localStorage<"u"&&localStorage.setItem(de,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&Vt([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(t){return t.postMessage({type:de,changedParts:e})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(e){if(e.key===de){var t=JSON.parse(e.newValue);t&&At(t.changedParts)}});var Yn=self.document&&navigator.serviceWorker;Yn&&Yn.addEventListener("message",ha)}function ha(e){var t=e.data;t&&t.type===de&&At(t.changedParts)}x.rejectionMapper=$r;rr(te,mr);function da(e,t,n=30,r=null){let i=[];for(let a of e){a={...a},delete a.limit,delete a.since,delete a.until;let o=new Map;for(let u of ya(a))o.set(JSON.stringify(u),[]);for(let u of t)pa(o,a,u);for(let[u,s]of o)va(i,u,s,n,r)}return i}function Ne(e,t,n,r,i=null,a=!1){if(n){if(t[n]&&t[n].length>1){for(let o of t[n])if(a){for(let u of r.tags)if(u[0]==i&&u[1]===o){Nt(e,{...t,[n]:[o]},r);break}}else if(i!=null&&r[i]===o){Nt(e,{...t,[n]:[o]},r);break}return!0}return!1}else Nt(e,t,r)}function Nt(e,t,n){let r=JSON.stringify(t),i=e.get(r);i?i.push(n):e.set(r,[n])}function pa(e,t,n){Ne(e,t,"authors",n,"pubkey",!1)||Ne(e,t,"ids",n,"ids",!1)||Ne(e,t,"#p",n,"p",!0)||Ne(e,t,"#e",n,"e",!0)||Ne(e,t,null,n)}function va(e,t,n,r,i){n=n.sort((a,o)=>a.created_at-o.created_at);for(let a=0;a<n.length;a+=r)r>1||n.length==1?e.push({filter:t,events:n.slice(a,a+r)}):e.push({filter:t,event:n[a]});i&&e.push({filter:t,query_info:i})}function ya(e){let t=[];if(e.authors&&e.authors.length>1)for(let n of e.authors)t.push({...e,authors:[n]});else if(e.ids&&e.ids.length>1)for(let n of e.ids)t.push({...e,ids:[n]});else if(e["#p"]&&e["#p"].length>1)for(let n of e["#p"])t.push({...e,"#p":[n]});else if(e["#e"]&&e["#e"].length>1)for(let n of e["#e"])t.push({...e,"#e":[n]});else t.push(e);return t}class ma extends On{constructor(){super("nostr_events",{chromeTransactionDurability:"relaxed"}),this.version(1).stores({events:"++,filter"})}}const Kr=new ma;function je(e,t,n){return t?e[t]&&e[t].length>1?n.anyOf(e[t].map(r=>JSON.stringify({...e,[t]:[r]}))):null:n.equals(JSON.stringify(e))}function ga(e,t){let n=je(e,"authors",t)||je(e,"ids",t)||je(e,"#p",t)||je(e,"#e",t)||je(e,null,t);if(!n)throw new Error("splitWhereClause bug");return n}function Tr(e,t,n=30,r=null){console.log("putEvents called with ",t.length," events");let i=da(e,t,n,r);return Kr.events.bulkPut(i)}function ba(e){let t;for(let n of e){let r=t?t.or("filter"):Kr.events.where("filter");n={...n},delete n.limit,t=ga(n,r)}return t?t.toArray().then(n=>{let r=n.map(a=>a.events||a.event||[]).flat(),i=n.filter(a=>a.query_info);return{events:r,query_infos:i}}):new Promise(n=>({events:[],query_infos:[]}))}function _a(e,t){return e.reduce((n,r)=>(n[t(r)]=r,n),new Map)}function Dn(e,t){return e.reduce((n,r)=>{const i=t(r);return n.get(i)||n.set(i,[]),n.get(i).push(r),n},new Map)}function wa(e){return[...new Set(e)]}function Ea(e,t){return new Map(Array.from(e.entries()).map(([n,r])=>[n,t(r)]))}function Sa(e,t){if(t={...t},t.ids){if(t.ids=t.ids.filter(n=>!e.find(r=>r.id==Ce(n))),!t.ids.length)return null}else if(t.authors){if(t.authors=t.authors.filter(n=>!e.find(r=>r.pubkey==Ce(n))),!t.authors.length)return null}else throw new Error("onlyOne option not supported for this filter"+JSON.stringify(t));return t}function xa(e,t,n,r,i){let a=[];for(let o of t){o={...o};let u=n.onlyOne;if(o.ids&&o.ids.length==0||o.authors&&o.authors.length==0||o.kinds&&o.kinds.length==0){console.timeLog(e,"no need to send subscription because filter is empty");continue}if(o.ids&&(u=!0),u){let l=Sa(r,o);if(!l){console.timeLog(e,"no need to send subscription because all events are already in the database");continue}o=l}if(o.authors&&!o.retrieve_old){console.log("splitting by authors",o.authors),console.log("events",r);let l=Dn(r,p=>p.pubkey),d=Ea(l,p=>Math.max(...p.map(m=>m.created_at)));console.log("last_created_at_by_author",d);let h=[];for(let p of o.authors){let m=d.get(Ce(p));if(m==null)h.push(p);else{let f={...o};f.authors=[p],f.since=m+1,a.push(yt(f))}}if(h.length==0)continue;o.authors=h}let s=!1;for(let l of Object.keys(o)){if(!l.startsWith("#"))continue;let d=o[l];console.log("Splitting by tag",l,d);let h=[];for(let p of d){let m=l.slice(1),f=Math.max(...r.filter(c=>c.tags.find(v=>v[0]==m&&v[1]==p)).map(c=>c.created_at));if(console.log("last_created_at",f,m,p),f==null)h.push(p);else{let c={...o};c[l]=[p],c.since=f+1,a.push(yt(c))}}if(h.length==0){s=!0;break}o[l]=h}s||a.push(yt(o))}if(a.length!=0)return a}let Ce=e=>typeof e=="string"?e:e[0];function yt(e){let t={};e.ids&&(t.ids=e.ids.map(Ce)),e.kinds&&(t.kinds=e.kinds),e.authors&&(t.authors=e.authors.map(Ce)),e.since&&(t.since=e.since),e.until&&(t.until=e.until),e.limit&&(t.limit=e.limit);for(let n of Object.keys(e))n.startsWith("#")&&(t[n]=e[n].map(Ce));return t}function Aa(e){var t,n;let r=!1,i=[];var a={},o={connect:[],disconnect:[],error:[],notice:[]},u={},s={};async function l(){return new Promise((m,f)=>{t=new WebSocket(e),t.onopen=()=>{r=!0;for(let c in a)h(["REQ",c,...a[c].filters]);for(let c of i)t.send(c);i=[],o.connect.forEach(c=>c()),m()},t.onerror=()=>{o.error.forEach(c=>c()),f()},t.onclose=async()=>{r=!1,o.disconnect.forEach(c=>c()),n&&n()},t.onmessage=async c=>{var w,_,b,g;var v;try{v=JSON.parse(c.data)}catch{v=c.data}if(v.length>=1)switch(v[0]){case"EVENT":if(v.length!==3)return;let y=v[1],E=v[2];Mr(E)&&a[y]&&(a[y].skipVerification||Fr(E))&&Nr(a[y].filters,E)&&(a[y],(((w=u[y])==null?void 0:w.event)||[]).forEach(S=>S(E)));return;case"EOSE":{if(v.length!==2)return;let S=v[1];(((_=u[S])==null?void 0:_.eose)||[]).forEach(K=>K());return}case"OK":{if(v.length<3)return;let S=v[1],K=v[2],C=v[3]||"";K?(b=s[S])==null||b.ok.forEach(B=>B()):(g=s[S])==null||g.failed.forEach(B=>B(C));return}case"NOTICE":if(v.length!==2)return;let A=v[1];o.notice.forEach(S=>S(A));return}}})}async function d(){t!=null&&t.readyState&&t.readyState===1||await l()}async function h(m){let f=JSON.stringify(m);r?t.send(f):i.push(f)}const p=(m,{skipVerification:f=!1,id:c=Math.random().toString().slice(2)}={})=>{let v=c;return a[v]={id:v,filters:m,skipVerification:f},r&&h(["REQ",v,...m]),{sub:(w,_={})=>p(w||m,{skipVerification:_.skipVerification||f,id:v}),unsub:()=>{delete a[v],delete u[v],r&&h(["CLOSE",v])},on:(w,_)=>{u[v]=u[v]||{event:[],eose:[]},u[v][w].push(_)},off:(w,_)=>{let b=u[v],g=b[w].indexOf(_);g>=0&&b[w].splice(g,1)}}};return{url:e,sub:p,on:(m,f)=>{o[m].push(f),m==="connect"&&(t==null?void 0:t.readyState)===1&&f()},off:(m,f)=>{let c=o[m].indexOf(f);c!==-1&&o[m].splice(c,1)},publish(m){if(!m.id)throw new Error(`event ${m} has no id`);let f=m.id;var c=!1,v=!1;h(["EVENT",m]).then(()=>{c=!0,v&&(w(),v=!1)}).catch(()=>{});const w=()=>{let _=p([{ids:[f]}],{id:`monitor-${f.slice(0,5)}`}),b=setTimeout(()=>{var g;(((g=s[f])==null?void 0:g.failed)||[]).forEach(y=>y("event not seen after 5 seconds")),_.unsub()},5e3);_.on("event",()=>{var g;clearTimeout(b),(((g=s[f])==null?void 0:g.seen)||[]).forEach(y=>y())})};return{on:(_,b)=>{s[f]=s[f]||{ok:[],seen:[],failed:[]},s[f][_].push(b),_==="seen"&&(c?w():v=!0)},off:(_,b)=>{let g=s[f];if(!g)return;let y=g[_].indexOf(b);y>=0&&g[_].splice(y,1)}}},connect:d,close(){return t.close(),new Promise(m=>{n=m})},get status(){return(t==null?void 0:t.readyState)??3}}}var jt=e=>[...new Set(e)],ka=class{constructor(e){Fe(this,"relayByUrl");if(this.relayByUrl=new Map,e)for(let t of jt(e))this.addOrGetRelay(t)}addOrGetRelay(e){let t=this.relayByUrl.get(e);return t||(t=Aa(e),this.relayByUrl.set(e,t),t.connect(),t)}close(){for(let e of this.relayByUrl.values())e.close();this.relayByUrl.clear()}sub(e,t){t=jt(t);let n=[];for(let r of t){let i=this.addOrGetRelay(r);n.push(i.sub(e))}return new Ka(n,t)}publish(e,t){for(let n of jt(t))this.addOrGetRelay(n).publish(e)}onnotice(e){this.relayByUrl.forEach((t,n)=>t.on("notice",r=>e(n+": "+r)))}onerror(e){this.relayByUrl.forEach((t,n)=>t.on("error",r=>e(n+": "+r)))}ondisconnect(e){this.relayByUrl.forEach((t,n)=>t.on("disconnect",r=>e(n+": "+r)))}},Ka=class{constructor(e,t){Fe(this,"subscriptions");Fe(this,"eventsBySub");Fe(this,"urlsBySub");this.subscriptions=e,this.eventsBySub=new Map,this.urlsBySub=new Map;for(let n=0;n<e.length;n++)this.urlsBySub.set(e[n],t[n])}onevent(e){return this.subscriptions.forEach(t=>{this.eventsBySub.set(t,[]),t.on("event",n=>{let r=this.eventsBySub.get(t);r&&r.push(n),e(n,r===void 0,this.urlsBySub.get(t))})}),()=>{this.subscriptions.forEach(t=>t.off("event",e))}}oneose(e){return this.subscriptions.forEach(t=>t.on("eose",()=>{let n=this.eventsBySub.get(t);this.eventsBySub.delete(t),e(n,this.urlsBySub.get(t))})),()=>{this.subscriptions.forEach(t=>t.off("eose",e))}}unsub(){this.subscriptions.forEach(e=>e.unsub())}};let Lt=0,Cr=["wss://relay.damus.io","wss://nostr.fmt.wiz.biz","wss://nostr.bongbong.com","wss://nostr-2.zebedee.cloud","wss://nostr.zaprite.io","wss://relay.nostr.ch","wss://nostr.delo.software","wss://nostr.nodeofsven.com","wss://nostr.oxtr.dev","wss://nostr-relay.wlvs.space"];const Ot=new ka(Cr);Ot.onerror=e=>{console.log("RelayPool error",e)};Ot.onnotice(e=>{console.log("RelayPool notice",e)});function Bn(e,t){for(let n of e)if(n.id==t)return!0;return!1}let Ta=e=>{var t;(t=e.sub)==null||t.unsub(),e.sub=void 0};function Ca(e,t){e.query_info.eose_received_at=hn(),e.query_info.total_events=e.events.length,e.query_info.new_events=t.length;let n=t.filter(r=>!Bn(e.events,r.id));console.timeLog(e.label,"EOSE with "+t.length+" events, from that "+t.length+" new, total events: ",e.events.length),console.log("Writing query info",e.query_info),Tr(e.filters,n,void 0,e.query_info),e.changed&&e.callback&&e.callback(e.events)}function Oa(e,t,n){e.changed=!0,e.events.push(t);let r=!1;n?(r=!0,console.time("callback"),e.callback(e.events),console.timeEnd("callback")):e.newEvents.push(t),r&&(Bn(e.storedEvents,t.id)||(Tr(e.filters,[t]),e.storedEvents.push(t)))}function Da(e,t,n){e.query_info.received_events++,Bn(e.events,t.id)||Oa(e,t,n)}Ot.ondisconnect(e=>{console.log("relay disconnected",e)});function Ba(e){console.log("relay.sub",e.subText,...e.filters);let t=Ot.sub(e.filters,Cr);e.sub=t,t.onevent((n,r)=>{console.log("event",e.subText,n),Da(e,n,r)}),t.oneose((n,r)=>{console.log("eose received at",r),n?Ca(e,n):console.warn("eose received without events (server sent eose twice")})}const hn=()=>Math.floor(Date.now()/1e3);function Or(e,t,n={}){let r=JSON.stringify(e);console.time(r);let i="sub"+Lt;Lt=Lt+1;let a=hn(),o;return ba(e.map(yt)).then(({events:u,query_infos:s})=>{let l=u.length;u.length&&t(u);let d=xa(r,e,n,u);console.timeLog(r,`got ${l} indexedDB events for filter, query_infos`,s,"filter_result",d),d&&(o={events:u,callback:t,filters:d,changed:!1,options:n,label:r,subText:i,newEvents:[],storedEvents:u,query_info:{db_queried_at:a,req_sent_at:hn(),received_events:0}},console.log("sending subscription REQ",i,...o.filters,", original label",o.label,", req_sent_at",o.query_info.req_sent_at),Ba(o))}),()=>{o&&(console.timeEnd(o.label),Ta(o),o.callback=null)}}function Pe(e,t){return Qn([],function(r){return Or(e,r,t)})}function Rn(e,t,n){let r=null;return Qn([],function(a){return e.subscribe(o=>{r&&r(),r=Or(t(o),a,n)}),()=>{r&&r()}})}let Ra=(e,t=500)=>Pe([{authors:[e],limit:t}]),Ia=(e,t=500)=>Pe([{"#p":[e],limit:t}]),Pa=(e,t)=>Rn(e,n=>{let r={kinds:[0],authors:[t]};console.log("filtering profiles",n);for(let i=0;i<n.length;i++){let a=n[i];r.authors=wa(r.authors.concat(a.tags.filter(o=>o[0]=="p"&&o[1]&&o[1].length>8).map(o=>o[1])))}return[r]},{onlyOne:!0}),Ma=e=>dn(e,t=>_a(t,n=>n.pubkey)),Fa=e=>dn(e,t=>{var r;return((r=t.findLast(i=>i.kind===ge.Contacts))==null?void 0:r.tags.map(i=>i[1]))||[]}),Na=e=>t=>t.filter(n=>n.kind===e),ja=(e,t=500)=>Rn(e,n=>[{authors:n,limit:t}]),Dr=e=>{let t=e.filter(i=>i.kind==ge.Text).map(i=>i.tags).flat().filter(i=>i[0]=="e").map(i=>i.slice(1)),n=Dn(t,i=>i[0]),r=[];for(let[i,a]of n){let o=a.map(u=>u.slice(1)).flat();r.push([i,...new Set(o)])}return{ids:r}},La=e=>dn(Pe([Dr(e)],{onlyOne:!0}),t=>Dn(t,n=>n.id));function Va(e,t=null){const{subscribe:n,set:r}=Gn(JSON.parse(localStorage.getItem(e))||t);return{subscribe:n,set:i=>{localStorage.setItem(e,JSON.stringify(i)),r(i)}}}function Br(e,t=null){const{subscribe:n,set:r}=Gn(localStorage.getItem(e)||t);return{subscribe:n,set:i=>{localStorage.setItem(e,i),r(i)}}}let Ua=()=>Br("nostr_profile_state");async function Wa(e){let t=Pe([{kinds:[ge.Contacts],authors:[e]}],{onlyOne:!0});return new Promise((n,r)=>{t.subscribe(i=>{i.length>0&&n(i[0].tags.filter(a=>a[0]=="p").map(a=>a[1]))})})}let za=(e,t)=>Pe([{authors:[e],limit:200},{"#p":[e],limit:200},{authors:[e],kinds:[ge.Contacts]},{authors:[e],kinds:[ge.Metadata]},{authors:t,limit:50},{"#p":t,limit:50},{authors:t,kinds:[ge.Contacts]},{authors:t,kinds:[ge.Metadata]}]);const Qa=Object.freeze(Object.defineProperty({__proto__:null,subscribeAndCacheResultsStore:Pe,derivedSubscribeStore:Rn,publishedStore:Ra,receivedStore:Ia,publishedProfilesStore:Pa,publishedProfilesByPubKeyStore:Ma,contactsStore:Fa,filterByKind:Na,eventsFromFollowedStore:ja,repliesFilter:Dr,repliesStore:La,localStorageJSONStore:Va,localStorageStore:Br,profileStateLocalStore:Ua,getFollowed:Wa,getEvents:za},Symbol.toStringTag,{value:"Module"}));export{za as a,ba as b,Qa as c,Dn as g,_a as m,Dr as r,Pe as s};
