import{v as Br,b as Ir,m as Pr,K as ge}from"./nostr.esm-d2518f25.js";import{r as Yn,d as hn,w as Qn}from"./index-fd964354.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var D=function(){return D=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},D.apply(this,arguments)};function Lt(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}var M=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N=Object.keys,U=Array.isArray;typeof Promise<"u"&&!M.Promise&&(M.Promise=Promise);function z(t,e){return typeof e!="object"||N(e).forEach(function(n){t[n]=e[n]}),t}var ze=Object.getPrototypeOf,Mr={}.hasOwnProperty;function H(t,e){return Mr.call(t,e)}function Oe(t,e){typeof e=="function"&&(e=e(ze(t))),(typeof Reflect>"u"?N:Reflect.ownKeys)(e).forEach(function(n){ue(t,n,e[n])})}var Gn=Object.defineProperty;function ue(t,e,n,r){Gn(t,e,z(n&&H(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function De(t){return{from:function(e){return t.prototype=Object.create(e.prototype),ue(t.prototype,"constructor",t),{extend:Oe.bind(null,t.prototype)}}}}var Fr=Object.getOwnPropertyDescriptor;function dn(t,e){var n=Fr(t,e),r;return n||(r=ze(t))&&dn(r,e)}var Nr=[].slice;function At(t,e,n){return Nr.call(t,e,n)}function Jn(t,e){return e(t)}function je(t){if(!t)throw new Error("Assertion Failed")}function Xn(t){M.setImmediate?setImmediate(t):setTimeout(t,0)}function $n(t,e){return t.reduce(function(n,r,i){var a=e(r,i);return a&&(n[a[0]]=a[1]),n},{})}function jr(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function oe(t,e){if(H(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var a=oe(t,e[r]);n.push(a)}return n}var o=e.indexOf(".");if(o!==-1){var u=t[e.substr(0,o)];return u===void 0?void 0:oe(u,e.substr(o+1))}}function X(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){je(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)X(t,e[r],n[r])}else{var a=e.indexOf(".");if(a!==-1){var o=e.substr(0,a),u=e.substr(a+1);if(u==="")n===void 0?U(t)&&!isNaN(parseInt(o))?t.splice(o,1):delete t[o]:t[o]=n;else{var s=t[o];(!s||!H(t,o))&&(s=t[o]={}),X(s,u,n)}}else n===void 0?U(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Lr(t,e){typeof e=="string"?X(t,e,void 0):"length"in e&&[].map.call(e,function(n){X(t,n,void 0)})}function Zn(t){var e={};for(var n in t)H(t,n)&&(e[n]=t[n]);return e}var Vr=[].concat;function er(t){return Vr.apply([],t)}var tr="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(er([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return M[t]}),Ur=tr.map(function(t){return M[t]});$n(tr,function(t){return[t,!0]});var he=null;function Xe(t){he=typeof WeakMap<"u"&&new WeakMap;var e=Vt(t);return he=null,e}function Vt(t){if(!t||typeof t!="object")return t;var e=he&&he.get(t);if(e)return e;if(U(t)){e=[],he&&he.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Vt(t[n]))}else if(Ur.indexOf(t.constructor)>=0)e=t;else{var i=ze(t);e=i===Object.prototype?{}:Object.create(i),he&&he.set(t,e);for(var a in t)H(t,a)&&(e[a]=Vt(t[a]))}return e}var Wr={}.toString;function Ut(t){return Wr.call(t).slice(8,-1)}var Wt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",zr=typeof Wt=="symbol"?function(t){var e;return t!=null&&(e=t[Wt])&&e.apply(t)}:function(){return null},Ke={};function ie(t){var e,n,r,i;if(arguments.length===1){if(U(t))return t.slice();if(this===Ke&&typeof t=="string")return[t];if(i=zr(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var pn=typeof Symbol<"u"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},te=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function nr(t,e){te=t,rr=e}var rr=function(){return!0},qr=!new Error("").stack;function xe(){if(qr)try{throw xe.arguments,new Error}catch(t){return t}return new Error}function zt(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(rr).map(function(r){return`
`+r}).join("")):""}var Hr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],ir=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],vn=Hr.concat(ir),Yr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Re(t,e){this._e=xe(),this.name=t,this.message=e}De(Re).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+zt(this._e,2))}},toString:function(){return this.name+": "+this.message}});function ar(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function yt(t,e,n,r){this._e=xe(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=ar(t,e)}De(yt).from(Re);function Ve(t,e){this._e=xe(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=ar(t,e)}De(Ve).from(Re);var yn=vn.reduce(function(t,e){return t[e]=e+"Error",t},{}),Qr=Re,T=vn.reduce(function(t,e){var n=e+"Error";function r(i,a){this._e=xe(),this.name=n,i?typeof i=="string"?(this.message=""+i+(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Yr[e]||n,this.inner=null)}return De(r).from(Qr),t[e]=r,t},{});T.Syntax=SyntaxError;T.Type=TypeError;T.Range=RangeError;var Bn=ir.reduce(function(t,e){return t[e+"Error"]=T[e],t},{});function Gr(t,e){if(!t||t instanceof Re||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Bn[t.name])return t;var n=new Bn[t.name](e||t.message,t);return"stack"in t&&ue(n,"stack",{get:function(){return this.inner.stack}}),n}var kt=vn.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=T[e]),t},{});kt.ModifyError=yt;kt.DexieError=Re;kt.BulkError=Ve;function P(){}function $e(t){return t}function Jr(t,e){return t==null||t===$e?e:function(n){return e(t(n))}}function Ee(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Xr(t,e){return t===P?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ee(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ee(i,this.onerror):i),a!==void 0?a:n}}function $r(t,e){return t===P?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ee(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ee(r,this.onerror):r)}}function Zr(t,e){return t===P?e:function(n){var r=t.apply(this,arguments);z(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ee(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Ee(a,this.onerror):a),r===void 0?o===void 0?void 0:o:z(r,o)}}function ei(t,e){return t===P?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function mn(t,e){return t===P?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return e.apply(r,a)})}return e.apply(this,arguments)}}var qe={},ti=100,ni=20,or=100,gn=typeof Promise>"u"?[]:function(){var t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,ze(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ze(e),t]}(),qt=gn[0],mt=gn[1],Ht=gn[2],ur=mt&&mt.then,lt=qt&&qt.constructor,bn=!!Ht,Yt=!1,ri=Ht?function(){Ht.then(it)}:M.setImmediate?setImmediate.bind(null,it):M.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){it(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(it,0)},He=function(t,e){Le.push([t,e]),gt&&(ri(),gt=!1)},Qt=!0,gt=!0,_e=[],ct=[],Gt=null,Jt=$e,Te={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Mn,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{Mn(t[0],t[1])}catch{}})}},k=Te,Le=[],we=0,ft=[];function x(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=P,this._lib=!1;var e=this._PSD=k;if(te&&(this._stackHolder=xe(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==qe)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&$t(this,this._value);return}this._state=null,this._value=null,++e.ref,lr(this,t)}var Xt={get:function(){var t=k,e=bt;function n(r,i){var a=this,o=!t.global&&(t!==k||e!==bt),u=o&&!se(),s=new x(function(l,d){_n(a,new sr(wt(r,t,o,u),wt(i,t,o,u),l,d,t))});return te&&hr(s,this),s}return n.prototype=qe,n},set:function(t){ue(this,"then",t&&t.prototype===qe?Xt:{get:function(){return t},set:Xt.set})}};Oe(x.prototype,{then:Xt,_then:function(t,e){_n(this,new sr(null,null,t,e,k))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):ht(r)}):this.then(null,function(r){return r&&r.name===e?n(r):ht(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),ht(e)})},stack:{get:function(){if(this._stack)return this._stack;try{Yt=!0;var t=fr(this,[],ni),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Yt=!1}}},timeout:function(t,e){var n=this;return t<1/0?new x(function(r,i){var a=setTimeout(function(){return i(new T.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&ue(x.prototype,Symbol.toStringTag,"Dexie.Promise");Te.env=dr();function sr(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}Oe(x,{all:function(){var t=ie.apply(null,arguments).map(_t);return new x(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(i,a){return x.resolve(i).then(function(o){t[a]=o,--r||e(t)},n)})})},resolve:function(t){if(t instanceof x)return t;if(t&&typeof t.then=="function")return new x(function(n,r){t.then(n,r)});var e=new x(qe,!0,t);return hr(e,Gt),e},reject:ht,race:function(){var t=ie.apply(null,arguments).map(_t);return new x(function(e,n){t.map(function(r){return x.resolve(r).then(e,n)})})},PSD:{get:function(){return k},set:function(t){return k=t}},totalEchoes:{get:function(){return bt}},newPSD:pe,usePSD:Ie,scheduler:{get:function(){return He},set:function(t){He=t}},rejectionMapper:{get:function(){return Jt},set:function(t){Jt=t}},follow:function(t,e){return new x(function(n,r){return pe(function(i,a){var o=k;o.unhandleds=[],o.onunhandled=a,o.finalize=Ee(function(){var u=this;ai(function(){u.unhandleds.length===0?i():a(u.unhandleds[0])})},o.finalize),t()},e,n,r)})}});lt&&(lt.allSettled&&ue(x,"allSettled",function(){var t=ie.apply(null,arguments).map(_t);return new x(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,a){return x.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--n||e(r)})})})}),lt.any&&typeof AggregateError<"u"&&ue(x,"any",function(){var t=ie.apply(null,arguments).map(_t);return new x(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(a,o){return x.resolve(a).then(function(u){return e(u)},function(u){i[o]=u,--r||n(new AggregateError(i))})})})}));function lr(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Ze();n&&typeof n.then=="function"?lr(t,function(i,a){n instanceof x?n._then(i,a):n.then(i,a)}):(t._state=!0,t._value=n,cr(t)),r&&et()}},$t.bind(null,t))}catch(n){$t(t,n)}}function $t(t,e){if(ct.push(e),t._state===null){var n=t._lib&&Ze();e=Jt(e),t._state=!1,t._value=e,te&&e!==null&&typeof e=="object"&&!e._promise&&jr(function(){var r=dn(e,"stack");e._promise=t,ue(e,"stack",{get:function(){return Yt?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),oi(t),cr(t),n&&et()}}function cr(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)_n(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),we===0&&(++we,He(function(){--we===0&&wn()},[]))}function _n(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++we,He(ii,[n,t,e])}function ii(t,e,n){try{Gt=e;var r,i=e._value;e._state?r=t(i):(ct.length&&(ct=[]),r=t(i),ct.indexOf(i)===-1&&ui(e)),n.resolve(r)}catch(a){n.reject(a)}finally{Gt=null,--we===0&&wn(),--n.psd.ref||n.psd.finalize()}}function fr(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,a,o;i!=null?(a=i.name||"Error",o=i.message||i,r=zt(i,0)):(a=i,o=""),e.push(a+(o?": "+o:"")+r)}return te&&(r=zt(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&fr(t._prev,e,n)),e}function hr(t,e){var n=e?e._numPrev+1:0;n<ti&&(t._prev=e,t._numPrev=n)}function it(){Ze()&&et()}function Ze(){var t=Qt;return Qt=!1,gt=!1,t}function et(){var t,e,n;do for(;Le.length>0;)for(t=Le,Le=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(Le.length>0);Qt=!0,gt=!0}function wn(){var t=_e;_e=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=ft.slice(0),n=e.length;n;)e[--n]()}function ai(t){function e(){t(),ft.splice(ft.indexOf(e),1)}ft.push(e),++we,He(function(){--we===0&&wn()},[])}function oi(t){_e.some(function(e){return e._value===t._value})||_e.push(t)}function ui(t){for(var e=_e.length;e;)if(_e[--e]._value===t._value){_e.splice(e,1);return}}function ht(t){return new x(qe,!1,t)}function F(t,e){var n=k;return function(){var r=Ze(),i=k;try{return ve(n,!0),t.apply(this,arguments)}catch(a){e&&e(a)}finally{ve(i,!1),r&&et()}}}var V={awaits:0,echoes:0,id:0},si=0,dt=[],Ot=0,bt=0,li=0;function pe(t,e,n,r){var i=k,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++li;var o=Te.env;a.env=bn?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:In(o.nthen,a),gthen:In(o.gthen,a)}:{},e&&z(a,e),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Ie(a,t,n,r);return a.ref===0&&a.finalize(),u}function Be(){return V.id||(V.id=++si),++V.awaits,V.echoes+=or,V.id}function se(){return V.awaits?(--V.awaits===0&&(V.id=0),V.echoes=V.awaits*or,!0):!1}(""+ur).indexOf("[native code]")===-1&&(Be=se=P);function _t(t){return V.echoes&&t&&t.constructor===lt?(Be(),t.then(function(e){return se(),e},function(e){return se(),j(e)})):t}function ci(t){++bt,(!V.echoes||--V.echoes===0)&&(V.echoes=V.id=0),dt.push(k),ve(t,!0)}function fi(){var t=dt[dt.length-1];dt.pop(),ve(t,!1)}function ve(t,e){var n=k;if((e?V.echoes&&(!Ot++||t!==k):Ot&&(!--Ot||t!==k))&&pr(e?ci.bind(null,t):fi),t!==k&&(k=t,n===Te&&(Te.env=dr()),bn)){var r=Te.env.Promise,i=t.env;mt.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(M,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function dr(){var t=M.Promise;return bn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(M,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:mt.then,gthen:t.prototype.then}:{}}function Ie(t,e,n,r,i){var a=k;try{return ve(t,!0),e(n,r,i)}finally{ve(a,!1)}}function pr(t){ur.call(qt,t)}function wt(t,e,n,r){return typeof t!="function"?t:function(){var i=k;n&&Be(),ve(e,!0);try{return t.apply(this,arguments)}finally{ve(i,!1),r&&pr(se)}}}function In(t,e){return function(n,r){return t.call(this,wt(n,e),wt(r,e))}}var Pn="unhandledrejection";function Mn(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(M.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Pn,!0,!0),z(r,i)):M.CustomEvent&&(r=new CustomEvent(Pn,{detail:i}),z(r,i)),r&&M.dispatchEvent&&(dispatchEvent(r),!M.PromiseRejectionEvent&&M.onunhandledrejection))try{M.onunhandledrejection(r)}catch{}te&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var j=x.reject;function Zt(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!k.letThrough&&!t._vip){if(t._state.openComplete)return j(new T.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return j(new T.DatabaseClosed);t.open().catch(P)}return t._state.dbReadyPromise.then(function(){return Zt(t,e,n,r)})}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(a){return a.name===yn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Zt(t,e,n,r)})):j(a)}return i._promise(e,function(a,o){return pe(function(){return k.trans=i,r(a,o,i)})}).then(function(a){return i._completion.then(function(){return a})})}}var Fn="3.2.2",be=String.fromCharCode(65535),en=-1/0,ne="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",vr="String expected.",Ue=[],Kt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),hi=Kt,di=Kt,yr=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},Tt="__dbnames",Dt="readonly",Rt="readwrite";function Se(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var mr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function at(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=Xe(e),delete e[t]),e}:function(e){return e}}var pi=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||k.trans,a=this.name;function o(s,l,d){if(!d.schema[a])throw new T.NotFound("Table "+a+" not part of transaction");return n(d.idbtrans,d)}var u=Ze();try{return i&&i.db===this.db?i===k.trans?i._promise(e,o,r):pe(function(){return i._promise(e,o,r)},{trans:i,transless:k.transless||k}):Zt(this.db,e,[this.name],o)}finally{u&&et()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(U(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=N(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(d){return d.compound&&n.every(function(h){return d.keyPath.indexOf(h)>=0})&&d.keyPath.every(function(h){return n.indexOf(h)>=0})})[0];if(r&&this.db._maxKey!==be)return this.where(r.name).equals(r.keyPath.map(function(d){return e[d]}));!r&&te&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,a=this.db._deps.indexedDB;function o(d,h){try{return a.cmp(d,h)===0}catch{return!1}}var u=n.reduce(function(d,h){var p=d[0],m=d[1],f=i[h],c=e[h];return[p||f,p||!f?Se(m,f&&f.multi?function(v){var w=oe(v,h);return U(w)&&w.some(function(_){return o(c,_)})}:function(v){return o(c,oe(v,h))}):m]},[null,null]),s=u[0],l=u[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,U(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var a in r)if(H(r,a))try{i[a]=r[a]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){z(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=e;return o&&a&&(u=at(o)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{X(e,o,s)}catch{}return s})},t.prototype.update=function(e,n){if(typeof e=="object"&&!U(e)){var r=oe(e,this.schema.primKey.keyPath);if(r===void 0)return j(new T.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?N(n).forEach(function(i){X(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=e;return o&&a&&(u=at(o)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?x.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{X(e,o,s)}catch{}return s})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?x.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:mr})}).then(function(n){return n.numFailures?x.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,d=s.keyPath;if(d&&a)throw new T.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,p=d&&l?e.map(at(d)):e;return i.core.mutate({trans:u,type:"add",keys:a,values:p,wantResults:o}).then(function(m){var f=m.numFailures,c=m.results,v=m.lastResult,w=m.failures,_=o?c:v;if(f===0)return _;throw new Ve(i.name+".bulkAdd(): "+f+" of "+h+" operations failed",w)})})},t.prototype.bulkPut=function(e,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,l=s.auto,d=s.keyPath;if(d&&a)throw new T.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,p=d&&l?e.map(at(d)):e;return i.core.mutate({trans:u,type:"put",keys:a,values:p,wantResults:o}).then(function(m){var f=m.numFailures,c=m.results,v=m.lastResult,w=m.failures,_=o?c:v;if(f===0)return _;throw new Ve(i.name+".bulkPut(): "+f+" of "+h+" operations failed",w)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var a=i.numFailures,o=i.lastResult,u=i.failures;if(a===0)return o;throw new Ve(n.name+".bulkDelete(): "+a+" of "+r+" operations failed",u)})},t}();function tt(t){var e={},n=function(u,s){if(s){for(var l=arguments.length,d=new Array(l-1);--l;)d[l-1]=arguments[l];return e[u].subscribe.apply(null,d),t}else if(typeof u=="string")return e[u]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(u,s,l){if(typeof u=="object")return o(u);s||(s=ei),l||(l=P);var d={subscribers:[],fire:l,subscribe:function(h){d.subscribers.indexOf(h)===-1&&(d.subscribers.push(h),d.fire=s(d.fire,h))},unsubscribe:function(h){d.subscribers=d.subscribers.filter(function(p){return p!==h}),d.fire=d.subscribers.reduce(s,l)}};return e[u]=n[u]=d,d}function o(u){N(u).forEach(function(s){var l=u[s];if(U(l))a(s,u[s][0],u[s][1]);else if(l==="asap")var d=a(s,$e,function(){for(var p=arguments.length,m=new Array(p);p--;)m[p]=arguments[p];d.subscribers.forEach(function(f){Xn(function(){f.apply(null,m)})})});else throw new T.InvalidArgument("Invalid event config")})}}function nt(t,e){return De(e).from({prototype:t}),e}function vi(t){return nt(pi.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:tt(null,{creating:[Xr,P],reading:[Jr,$e],updating:[Zr,P],deleting:[$r,P]})})}function Ae(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Bt(t,e){t.filter=Se(t.filter,e)}function It(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Se(r(),e())}:e,t.justLimit=n&&!r}function yi(t,e){t.isMatch=Se(t.isMatch,e)}function pt(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new T.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Nn(t,e,n){var r=pt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function ot(t,e,n,r){var i=t.replayFilter?Se(t.filter,t.replayFilter()):t.filter;if(t.or){var a={},o=function(u,s,l){if(!i||i(s,l,function(p){return s.stop(p)},function(p){return s.fail(p)})){var d=s.primaryKey,h=""+d;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(d)),H(a,h)||(a[h]=!0,e(u,s,l))}};return Promise.all([t.or._iterate(o,n),jn(Nn(t,r,n),t.algorithm,o,!t.keysOnly&&t.valueMapper)])}else return jn(Nn(t,r,n),Se(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function jn(t,e,n,r){var i=r?function(o,u,s){return n(r(o),u,s)}:n,a=F(i);return t.then(function(o){if(o)return o.start(function(){var u=function(){return o.continue()};(!e||e(o,function(s){return u=s},function(s){o.stop(s),u=P},function(s){o.fail(s),u=P}))&&a(o.value,o,function(s){return u=s}),u()})})}function W(t,e){try{var n=Ln(t),r=Ln(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return gi(Vn(t),Vn(e));case"Array":return mi(t,e)}}catch{}return NaN}function mi(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,a=0;a<i;++a){var o=W(t[a],e[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function gi(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,a=0;a<i;++a)if(t[a]!==e[a])return t[a]<e[a]?-1:1;return n===r?0:n<r?-1:1}function Ln(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=Ut(t);return n==="ArrayBuffer"?"binary":n}function Vn(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var bi=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,j.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,j.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Se(n.algorithm,e)},t.prototype._iterate=function(e,n){return ot(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&z(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return ot(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ae(i,!0))return a.count({trans:r,query:{index:pt(i,a.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var o=0;return ot(i,function(){return++o,!1},r,a).then(function(){return o})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],a=r.length-1;function o(l,d){return d?o(l[r[d]],d-1):l[i]}var u=this._ctx.dir==="next"?1:-1;function s(l,d){var h=o(l,a),p=o(d,a);return h<p?-u:h>p?u:0}return this.toArray(function(l){return l.sort(s)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ae(i,!0)&&i.limit>0){var a=i.valueMapper,o=pt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(s){var l=s.result;return a?l.map(a):l})}else{var u=[];return ot(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Ae(n)?It(n,function(){var r=e;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):It(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),It(this._ctx,function(){var n=e;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},t.prototype.until=function(e,n){return Bt(this._ctx,function(r,i,a){return e(r.value)?(i(a),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return Bt(this._ctx,function(n){return e(n.value)}),yi(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&Ae(n,!0)&&n.limit>0)return this._read(function(i){var a=pt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return Bt(this._ctx,function(i){var a=i.primaryKey.toString(),o=H(r,a);return r[a]=!0,!o}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof e=="function")a=e;else{var o=N(e),u=o.length;a=function(w){for(var _=!1,b=0;b<u;++b){var g=o[b],y=e[g];oe(w,g)!==y&&(X(w,g,y),_=!0)}return _}}var s=r.table.core,l=s.schema.primaryKey,d=l.outbound,h=l.extractKey,p=n.db._options.modifyChunkSize||200,m=[],f=0,c=[],v=function(w,_){var b=_.failures,g=_.numFailures;f+=w-g;for(var y=0,E=N(b);y<E.length;y++){var A=E[y];m.push(b[A])}};return n.clone().primaryKeys().then(function(w){var _=function(b){var g=Math.min(p,w.length-b);return s.getMany({trans:i,keys:w.slice(b,b+g),cache:"immutable"}).then(function(y){for(var E=[],A=[],S=d?[]:null,K=[],C=0;C<g;++C){var R=y[C],I={value:Xe(R),primKey:w[b+C]};a.call(I,I.value,I)!==!1&&(I.value==null?K.push(w[b+C]):!d&&W(h(R),h(I.value))!==0?(K.push(w[b+C]),E.push(I.value)):(A.push(I.value),d&&S.push(w[b+C])))}var B=Ae(r)&&r.limit===1/0&&(typeof e!="function"||e===Pt)&&{index:r.index,range:r.range};return Promise.resolve(E.length>0&&s.mutate({trans:i,type:"add",values:E}).then(function(L){for(var O in L.failures)K.splice(parseInt(O),1);v(E.length,L)})).then(function(){return(A.length>0||B&&typeof e=="object")&&s.mutate({trans:i,type:"put",keys:S,values:A,criteria:B,changeSpec:typeof e!="function"&&e}).then(function(L){return v(A.length,L)})}).then(function(){return(K.length>0||B&&e===Pt)&&s.mutate({trans:i,type:"delete",keys:K,criteria:B}).then(function(L){return v(K.length,L)})}).then(function(){return w.length>b+g&&_(b+p)})})};return _(0).then(function(){if(m.length>0)throw new yt("Error modifying one or more objects",m,f,c);return w.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Ae(e)&&(e.isPrimKey&&!di||n.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,a=n;return e.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return e.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(u){var s=u.failures;u.lastResult,u.results;var l=u.numFailures;if(l)throw new yt("Could not delete some values",Object.keys(s).map(function(d){return s[d]}),o-l);return o-l})})}):this.modify(Pt)},t}(),Pt=function(t,e){return e.value=null};function _i(t){return nt(bi.prototype,function(n,r){this.db=t;var i=mr,a=null;if(r)try{i=r()}catch(l){a=l}var o=n._ctx,u=o.table,s=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:s!==$e?s:null}})}function wi(t,e){return t<e?-1:t===e?0:1}function Ei(t,e){return t>e?-1:t===e?0:1}function q(t,e,n){var r=t instanceof br?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function ke(t){return new t.Collection(t,function(){return gr("")}).limit(0)}function Si(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function xi(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function Ai(t,e,n,r,i,a){for(var o=Math.min(t.length,r.length),u=-1,s=0;s<o;++s){var l=e[s];if(l!==r[s])return i(t[s],n[s])<0?t.substr(0,s)+n[s]+n.substr(s+1):i(t[s],r[s])<0?t.substr(0,s)+r[s]+n.substr(s+1):u>=0?t.substr(0,u)+e[u]+n.substr(u+1):null;i(t[s],l)<0&&(u=s)}return o<r.length&&a==="next"?t+n.substr(t.length):o<t.length&&a==="prev"?t.substr(0,n.length):u<0?null:t.substr(0,u)+r[u]+n.substr(u+1)}function ut(t,e,n,r){var i,a,o,u,s,l,d,h=n.length;if(!n.every(function(c){return typeof c=="string"}))return q(t,vr);function p(c){i=Si(c),a=xi(c),o=c==="next"?wi:Ei;var v=n.map(function(w){return{lower:a(w),upper:i(w)}}).sort(function(w,_){return o(w.lower,_.lower)});u=v.map(function(w){return w.upper}),s=v.map(function(w){return w.lower}),l=c,d=c==="next"?"":r}p("next");var m=new t.Collection(t,function(){return fe(u[0],s[h-1]+r)});m._ondirectionchange=function(c){p(c)};var f=0;return m._addAlgorithm(function(c,v,w){var _=c.key;if(typeof _!="string")return!1;var b=a(_);if(e(b,s,f))return!0;for(var g=null,y=f;y<h;++y){var E=Ai(_,b,u[y],s[y],o,l);E===null&&g===null?f=y+1:(g===null||o(g,E)>0)&&(g=E)}return v(g!==null?function(){c.continue(g+d)}:w),!1}),m}function fe(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function gr(t){return{type:1,lower:t,upper:t}}var br=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?ke(this):new this.Collection(this,function(){return fe(e,n,!r,!i)})}catch{return q(this,ne)}},t.prototype.equals=function(e){return e==null?q(this,ne):new this.Collection(this,function(){return gr(e)})},t.prototype.above=function(e){return e==null?q(this,ne):new this.Collection(this,function(){return fe(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?q(this,ne):new this.Collection(this,function(){return fe(e,void 0,!1)})},t.prototype.below=function(e){return e==null?q(this,ne):new this.Collection(this,function(){return fe(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?q(this,ne):new this.Collection(this,function(){return fe(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?q(this,vr):this.between(e,e+be,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):ut(this,function(n,r){return n.indexOf(r[0])===0},[e],be)},t.prototype.equalsIgnoreCase=function(e){return ut(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=ie.apply(Ke,arguments);return e.length===0?ke(this):ut(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=ie.apply(Ke,arguments);return e.length===0?ke(this):ut(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},e,be)},t.prototype.anyOf=function(){var e=this,n=ie.apply(Ke,arguments),r=this._cmp;try{n.sort(r)}catch{return q(this,ne)}if(n.length===0)return ke(this);var i=new this.Collection(this,function(){return fe(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?e._ascending:e._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(o,u,s){for(var l=o.key;r(l,n[a])>0;)if(++a,a===n.length)return u(s),!1;return r(l,n[a])===0?!0:(u(function(){o.continue(n[a])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[en,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=ie.apply(Ke,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return q(this,ne)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[en,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,a=this._ascending,o=this._descending,u=this._min,s=this._max;if(e.length===0)return ke(this);if(!e.every(function(y){return y[0]!==void 0&&y[1]!==void 0&&a(y[0],y[1])<=0}))return q(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",T.InvalidArgument);var l=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0;function h(y,E){for(var A=0,S=y.length;A<S;++A){var K=y[A];if(i(E[0],K[1])<0&&i(E[1],K[0])>0){K[0]=u(K[0],E[0]),K[1]=s(K[1],E[1]);break}}return A===S&&y.push(E),y}var p=a;function m(y,E){return p(y[0],E[0])}var f;try{f=e.reduce(h,[]),f.sort(m)}catch{return q(this,ne)}var c=0,v=d?function(y){return a(y,f[c][1])>0}:function(y){return a(y,f[c][1])>=0},w=l?function(y){return o(y,f[c][0])>0}:function(y){return o(y,f[c][0])>=0};function _(y){return!v(y)&&!w(y)}var b=v,g=new this.Collection(this,function(){return fe(f[0][0],f[f.length-1][1],!l,!d)});return g._ondirectionchange=function(y){y==="next"?(b=v,p=a):(b=w,p=o),f.sort(m)},g._addAlgorithm(function(y,E,A){for(var S=y.key;b(S);)if(++c,c===f.length)return E(A),!1;return _(S)?!0:(r._cmp(S,f[c][1])===0||r._cmp(S,f[c][0])===0||E(function(){p===a?y.continue(f[c][0]):y.continue(f[c][1])}),!1)}),g},t.prototype.startsWithAnyOf=function(){var e=ie.apply(Ke,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?ke(this):this.inAnyRange(e.map(function(n){return[n,n+be]})):q(this,"startsWithAnyOf() only works with strings")},t}();function ki(t){return nt(br.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};var a=t._deps.indexedDB;if(!a)throw new T.MissingAPI;this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(o,u){return a.cmp(u,o)},this._max=function(o,u){return a.cmp(o,u)>0?o:u},this._min=function(o,u){return a.cmp(o,u)<0?o:u},this._IDBKeyRange=t._deps.IDBKeyRange})}function ee(t){return F(function(e){return Ye(e),t(e.target.error),!1})}function Ye(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var Qe="storagemutated",de="x-storagemutated-1",ye=tt(null,Qe),Ki=function(){function t(){}return t.prototype._lock=function(){return je(!k.global),++this._reculock,this._reculock===1&&!k.global&&(k.lockOwnerFor=this),this},t.prototype._unlock=function(){if(je(!k.global),--this._reculock===0)for(k.global||(k.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Ie(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&k.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(je(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new T.DatabaseClosed(i);case"MissingAPIError":throw new T.MissingAPI(i.message,i);default:throw new T.OpenFailed(i)}if(!this.active)throw new T.TransactionInactive;return je(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=F(function(a){Ye(a),n._reject(e.error)}),e.onabort=F(function(a){Ye(a),n.active&&n._reject(new T.Abort(e.error)),n.active=!1,n.on("abort").fire(a)}),e.oncomplete=F(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&ye.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return j(new T.ReadOnly("Transaction is readonly"));if(!this.active)return j(new T.TransactionInactive);if(this._locked())return new x(function(o,u){i._blockedFuncs.push([function(){i._promise(e,n,r).then(o,u)},k])});if(r)return pe(function(){var o=new x(function(u,s){i._lock();var l=n(u,s,i);l&&l.then&&l.then(u,s)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new x(function(o,u){var s=n(o,u,i);s&&s.then&&s.then(o,u)});return a._lib=!0,a},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=x.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new x(function(o,u){r.then(function(s){return n._waitingQueue.push(F(o.bind(null,s)))},function(s){return n._waitingQueue.push(F(u.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new T.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(H(n,e))return n[e];var r=this.schema[e];if(!r)throw new T.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function Ti(t){return nt(Ki.prototype,function(n,r,i,a,o){var u=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=tt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x(function(s,l){u._resolve=s,u._reject=l}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var l=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):l&&u.idbtrans&&u.idbtrans.abort(),j(s)})})}function tn(t,e,n,r,i,a,o){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+_r(e)}}function _r(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function wr(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:$n(n,function(r){return[r.name,r]})}}function Ci(t){return t.length===1?t[0]:t}var Ge=function(t){try{return t.only([[]]),Ge=function(){return[[]]},[[]]}catch{return Ge=function(){return be},be}};function nn(t){return t==null?function(){}:typeof t=="string"?Oi(t):function(e){return oe(e,t)}}function Oi(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return oe(n,t)}}function Un(t){return[].slice.call(t)}var Di=0;function We(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function Ri(t,e,n){function r(h,p){var m=Un(h.objectStoreNames);return{schema:{name:h.name,tables:m.map(function(f){return p.objectStore(f)}).map(function(f){var c=f.keyPath,v=f.autoIncrement,w=U(c),_=c==null,b={},g={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_,compound:w,keyPath:c,autoIncrement:v,unique:!0,extractKey:nn(c)},indexes:Un(f.indexNames).map(function(y){return f.index(y)}).map(function(y){var E=y.name,A=y.unique,S=y.multiEntry,K=y.keyPath,C=U(K),R={name:E,compound:C,keyPath:K,unique:A,multiEntry:S,extractKey:nn(K)};return b[We(K)]=R,R}),getIndexByKeyPath:function(y){return b[We(y)]}};return b[":id"]=g.primaryKey,c!=null&&(b[We(c)]=g.primaryKey),g})},hasGetAll:m.length>0&&"getAll"in p.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(h){if(h.type===3)return null;if(h.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var p=h.lower,m=h.upper,f=h.lowerOpen,c=h.upperOpen,v=p===void 0?m===void 0?null:e.upperBound(m,!!c):m===void 0?e.lowerBound(p,!!f):e.bound(p,m,!!f,!!c);return v}function a(h){var p=h.name;function m(v){var w=v.trans,_=v.type,b=v.keys,g=v.values,y=v.range;return new Promise(function(E,A){E=F(E);var S=w.objectStore(p),K=S.keyPath==null,C=_==="put"||_==="add";if(!C&&_!=="delete"&&_!=="deleteRange")throw new Error("Invalid operation type: "+_);var R=(b||g||{length:1}).length;if(b&&g&&b.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(R===0)return E({numFailures:0,failures:{},results:[],lastResult:void 0});var I,B=[],L=[],O=0,Y=function(Z){++O,Ye(Z)};if(_==="deleteRange"){if(y.type===4)return E({numFailures:O,failures:L,results:[],lastResult:void 0});y.type===3?B.push(I=S.clear()):B.push(I=S.delete(i(y)))}else{var G=C?K?[g,b]:[g,null]:[b,null],le=G[0],$=G[1];if(C)for(var Q=0;Q<R;++Q)B.push(I=$&&$[Q]!==void 0?S[_](le[Q],$[Q]):S[_](le[Q])),I.onerror=Y;else for(var Q=0;Q<R;++Q)B.push(I=S[_](le[Q])),I.onerror=Y}var ce=function(Z){var Me=Z.target.result;B.forEach(function(J,rt){return J.error!=null&&(L[rt]=J.error)}),E({numFailures:O,failures:L,results:_==="delete"?b:B.map(function(J){return J.result}),lastResult:Me})};I.onerror=function(Z){Y(Z),ce(Z)},I.onsuccess=ce})}function f(v){var w=v.trans,_=v.values,b=v.query,g=v.reverse,y=v.unique;return new Promise(function(E,A){E=F(E);var S=b.index,K=b.range,C=w.objectStore(p),R=S.isPrimaryKey?C:C.index(S.name),I=g?y?"prevunique":"prev":y?"nextunique":"next",B=_||!("openKeyCursor"in R)?R.openCursor(i(K),I):R.openKeyCursor(i(K),I);B.onerror=ee(A),B.onsuccess=F(function(L){var O=B.result;if(!O){E(null);return}O.___id=++Di,O.done=!1;var Y=O.continue.bind(O),G=O.continuePrimaryKey;G&&(G=G.bind(O));var le=O.advance.bind(O),$=function(){throw new Error("Cursor not started")},Q=function(){throw new Error("Cursor not stopped")};O.trans=w,O.stop=O.continue=O.continuePrimaryKey=O.advance=$,O.fail=F(A),O.next=function(){var ce=this,Z=1;return this.start(function(){return Z--?ce.continue():ce.stop()}).then(function(){return ce})},O.start=function(ce){var Z=new Promise(function(J,rt){J=F(J),B.onerror=ee(rt),O.fail=rt,O.stop=function(Rr){O.stop=O.continue=O.continuePrimaryKey=O.advance=Q,J(Rr)}}),Me=function(){if(B.result)try{ce()}catch(J){O.fail(J)}else O.done=!0,O.start=function(){throw new Error("Cursor behind last entry")},O.stop()};return B.onsuccess=F(function(J){B.onsuccess=Me,Me()}),O.continue=Y,O.continuePrimaryKey=G,O.advance=le,Me(),Z},E(O)},A)})}function c(v){return function(w){return new Promise(function(_,b){_=F(_);var g=w.trans,y=w.values,E=w.limit,A=w.query,S=E===1/0?void 0:E,K=A.index,C=A.range,R=g.objectStore(p),I=K.isPrimaryKey?R:R.index(K.name),B=i(C);if(E===0)return _({result:[]});if(v){var L=y?I.getAll(B,S):I.getAllKeys(B,S);L.onsuccess=function(le){return _({result:le.target.result})},L.onerror=ee(b)}else{var O=0,Y=y||!("openKeyCursor"in I)?I.openCursor(B):I.openKeyCursor(B),G=[];Y.onsuccess=function(le){var $=Y.result;if(!$)return _({result:G});if(G.push(y?$.value:$.primaryKey),++O===E)return _({result:G});$.continue()},Y.onerror=ee(b)}})}}return{name:p,schema:h,mutate:m,getMany:function(v){var w=v.trans,_=v.keys;return new Promise(function(b,g){b=F(b);for(var y=w.objectStore(p),E=_.length,A=new Array(E),S=0,K=0,C,R=function(O){var Y=O.target;(A[Y._pos]=Y.result)!=null,++K===S&&b(A)},I=ee(g),B=0;B<E;++B){var L=_[B];L!=null&&(C=y.get(_[B]),C._pos=B,C.onsuccess=R,C.onerror=I,++S)}S===0&&b(A)})},get:function(v){var w=v.trans,_=v.key;return new Promise(function(b,g){b=F(b);var y=w.objectStore(p),E=y.get(_);E.onsuccess=function(A){return b(A.target.result)},E.onerror=ee(g)})},query:c(s),openCursor:f,count:function(v){var w=v.query,_=v.trans,b=w.index,g=w.range;return new Promise(function(y,E){var A=_.objectStore(p),S=b.isPrimaryKey?A:A.index(b.name),K=i(g),C=K?S.count(K):S.count();C.onsuccess=F(function(R){return y(R.target.result)}),C.onerror=ee(E)})}}}var o=r(t,n),u=o.schema,s=o.hasGetAll,l=u.tables.map(function(h){return a(h)}),d={};return l.forEach(function(h){return d[h.name]=h}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(h){var p=d[h];if(!p)throw new Error("Table '"+h+"' not found");return d[h]},MIN_KEY:-1/0,MAX_KEY:Ge(e),schema:u}}function Bi(t,e){return e.reduce(function(n,r){var i=r.create;return D(D({},n),i(n))},t)}function Ii(t,e,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=Bi(Ri(e,i,r),t.dbcore);return{dbcore:a}}function En(t,e){var n=t._novip,r=e.db,i=Ii(n._middlewares,r,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(a){var o=a.name;n.core.schema.tables.some(function(u){return u.name===o})&&(a.core=n.core.table(o),n[o]instanceof n.Table&&(n[o].core=a.core))})}function Et(t,e,n,r){var i=t._novip;n.forEach(function(a){var o=r[a];e.forEach(function(u){var s=dn(u,a);(!s||"value"in s&&s.value===void 0)&&(u===i.Transaction.prototype||u instanceof i.Transaction?ue(u,a,{get:function(){return this.table(a)},set:function(l){Gn(this,a,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):u[a]=new i.Table(a,o))})})}function rn(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Pi(t,e){return t._cfg.version-e._cfg.version}function Mi(t,e,n,r){var i=t._dbSchema,a=t._createTransaction("readwrite",t._storeNames,i);a.create(n),a._completion.catch(r);var o=a._reject.bind(a),u=k.transless||k;pe(function(){k.trans=a,k.transless=u,e===0?(N(i).forEach(function(s){Sn(n,s,i[s].primKey,i[s].indexes)}),En(t,n),x.follow(function(){return t.on.populate.fire(a)}).catch(o)):Fi(t,e,a,n).catch(o)})}function Fi(t,e,n,r){var i=t._novip,a=[],o=i._versions,u=i._dbSchema=xn(i,i.idbdb,r),s=!1,l=o.filter(function(h){return h._cfg.version>=e});l.forEach(function(h){a.push(function(){var p=u,m=h._cfg.dbschema;on(i,p,r),on(i,m,r),u=i._dbSchema=m;var f=Er(p,m);f.add.forEach(function(g){Sn(r,g[0],g[1].primKey,g[1].indexes)}),f.change.forEach(function(g){if(g.recreate)throw new T.Upgrade("Not yet support for changing primary key");var y=r.objectStore(g.name);g.add.forEach(function(E){return an(y,E)}),g.change.forEach(function(E){y.deleteIndex(E.name),an(y,E)}),g.del.forEach(function(E){return y.deleteIndex(E)})});var c=h._cfg.contentUpgrade;if(c&&h._cfg.version>e){En(i,r),n._memoizedTables={},s=!0;var v=Zn(m);f.del.forEach(function(g){v[g]=p[g]}),rn(i,[i.Transaction.prototype]),Et(i,[i.Transaction.prototype],N(v),v),n.schema=v;var w=pn(c);w&&Be();var _,b=x.follow(function(){if(_=c(n),_&&w){var g=se.bind(null,null);_.then(g,g)}});return _&&typeof _.then=="function"?x.resolve(_):b.then(function(){return _})}}),a.push(function(p){if(!s||!hi){var m=h._cfg.dbschema;ji(m,p)}rn(i,[i.Transaction.prototype]),Et(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function d(){return a.length?x.resolve(a.shift()(n.idbtrans)).then(d):x.resolve()}return d().then(function(){Ni(u,r)})}function Er(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],a=e[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!Kt)o.recreate=!0,n.change.push(o);else{var u=i.idxByName,s=a.idxByName,l=void 0;for(l in u)s[l]||o.del.push(l);for(l in s){var d=u[l],h=s[l];d?d.src!==h.src&&o.change.push(h):o.add.push(h)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function Sn(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return an(i,a)}),i}function Ni(t,e){N(t).forEach(function(n){e.db.objectStoreNames.contains(n)||Sn(e,n,t[n].primKey,t[n].indexes)})}function ji(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function an(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function xn(t,e,n){var r={},i=At(e.objectStoreNames,0);return i.forEach(function(a){for(var o=n.objectStore(a),u=o.keyPath,s=tn(_r(u),u||"",!1,!1,!!o.autoIncrement,u&&typeof u!="string",!0),l=[],d=0;d<o.indexNames.length;++d){var h=o.index(o.indexNames[d]);u=h.keyPath;var p=tn(h.name,u,!!h.unique,!!h.multiEntry,!1,u&&typeof u!="string",!1);l.push(p)}r[a]=wr(a,s,l)}),r}function Li(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=xn(r,e,n);r._storeNames=At(e.objectStoreNames,0),Et(r,[r._allTables],N(i),i)}function Vi(t,e){var n=xn(t,t.idbdb,e),r=Er(n,t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function on(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,a=0;a<i.length;++a){var o=i[a],u=n.objectStore(o);r._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var l=u.indexNames[s],d=u.index(l).keyPath,h=typeof d=="string"?d:"["+At(d).join("+")+"]";if(e[o]){var p=e[o].idxByName[h];p&&(p.name=l,delete e[o].idxByName[h],e[o].idxByName[l]=p)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&M.WorkerGlobalScope&&M instanceof M.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Ui(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return tn(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),U(i),n===0)})}var Wi=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){N(e).forEach(function(r){if(e[r]!==null){var i=Ui(e[r]),a=i.shift();if(a.multi)throw new T.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new T.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new T.Schema("Index must have a name and cannot be an empty string")}),n[r]=wr(r,a,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?z(this._cfg.storesSource,e):e;var r=n._versions,i={},a={};return r.forEach(function(o){z(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),n._dbSchema=a,rn(n,[n._allTables,n,n.Transaction.prototype]),Et(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],N(a),a),n._storeNames=N(a),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=mn(this._cfg.contentUpgrade||P,e),this},t}();function zi(t){return nt(Wi.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function An(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Cn(Tt,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function kn(t){return t&&typeof t.databases=="function"}function qi(t){var e=t.indexedDB,n=t.IDBKeyRange;return kn(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Tt})}):An(e,n).toCollection().primaryKeys()}function Hi(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!kn(n)&&e!==Tt&&An(n,r).put({name:e}).catch(P)}function Yi(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!kn(n)&&e!==Tt&&An(n,r).delete(e).catch(P)}function un(t){return pe(function(){return k.letThrough=!0,t()})}function Qi(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function Gi(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?j(e.dbOpenError):t});te&&(e.openCanceller._stackHolder=xe()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new T.DatabaseClosed("db.open() was cancelled")}var a=e.dbReadyResolve,o=null,u=!1;return x.race([r,(typeof navigator>"u"?x.resolve():Qi()).then(function(){return new x(function(s,l){if(i(),!n)throw new T.MissingAPI;var d=t.name,h=e.autoSchema?n.open(d):n.open(d,Math.round(t.verno*10));if(!h)throw new T.MissingAPI;h.onerror=ee(l),h.onblocked=F(t._fireOnBlocked),h.onupgradeneeded=F(function(p){if(o=h.transaction,e.autoSchema&&!t._options.allowEmptyDB){h.onerror=Ye,o.abort(),h.result.close();var m=n.deleteDatabase(d);m.onsuccess=m.onerror=F(function(){l(new T.NoSuchDatabase("Database "+d+" doesnt exist"))})}else{o.onerror=ee(l);var f=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;u=f<1,t._novip.idbdb=h.result,Mi(t,f/10,o,l)}},l),h.onsuccess=F(function(){o=null;var p=t._novip.idbdb=h.result,m=At(p.objectStoreNames);if(m.length>0)try{var f=p.transaction(Ci(m),"readonly");e.autoSchema?Li(t,p,f):(on(t,t._dbSchema,f),Vi(t,f)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),En(t,f)}catch{}Ue.push(t),p.onversionchange=F(function(c){e.vcFired=!0,t.on("versionchange").fire(c)}),p.onclose=F(function(c){t.on("close").fire(c)}),u&&Hi(t._deps,d),s()},l)})})]).then(function(){return i(),e.onReadyBeingFired=[],x.resolve(un(function(){return t.on.ready.fire(t.vip)})).then(function s(){if(e.onReadyBeingFired.length>0){var l=e.onReadyBeingFired.reduce(mn,P);return e.onReadyBeingFired=[],x.resolve(un(function(){return l(t.vip)})).then(s)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(s){e.dbOpenError=s;try{o&&o.abort()}catch{}return r===e.openCanceller&&t._close(),j(s)}).finally(function(){e.openComplete=!0,a()})}function sn(t){var e=function(o){return t.next(o)},n=function(o){return t.throw(o)},r=a(e),i=a(n);function a(o){return function(u){var s=o(u),l=s.value;return s.done?l:!l||typeof l.then!="function"?U(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return a(e)()}function Ji(t,e,n){var r=arguments.length;if(r<2)throw new T.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=er(i);return[t,a,n]}function Sr(t,e,n,r,i){return x.resolve().then(function(){var a=k.transless||k,o=t._createTransaction(e,n,t._dbSchema,r),u={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),t._state.PR1398_maxLoop=3}catch(h){return h.name===yn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Sr(t,e,n,null,i)})):j(h)}var s=pn(i);s&&Be();var l,d=x.follow(function(){if(l=i.call(o,o),l)if(s){var h=se.bind(null,null);l.then(h,h)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=sn(l))},u);return(l&&typeof l.then=="function"?x.resolve(l).then(function(h){return o.active?h:j(new T.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):d.then(function(){return l})).then(function(h){return r&&o._resolve(),o._completion.then(function(){return h})}).catch(function(h){return o._reject(h),j(h)})})}function st(t,e,n){for(var r=U(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}function Xi(t){return D(D({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},a=[];function o(c,v,w){var _=We(c),b=i[_]=i[_]||[],g=c==null?0:typeof c=="string"?1:c.length,y=v>0,E=D(D({},w),{isVirtual:y,keyTail:v,keyLength:g,extractKey:nn(c),unique:!y&&w.unique});if(b.push(E),E.isPrimaryKey||a.push(E),g>1){var A=g===2?c[0]:c.slice(0,g-1);o(A,v+1,w)}return b.sort(function(S,K){return S.keyTail-K.keyTail}),E}var u=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,l=r.indexes;s<l.length;s++){var d=l[s];o(d.keyPath,0,d)}function h(c){var v=i[We(c)];return v&&v[0]}function p(c,v){return{type:c.type===1?2:c.type,lower:st(c.lower,c.lowerOpen?t.MAX_KEY:t.MIN_KEY,v),lowerOpen:!0,upper:st(c.upper,c.upperOpen?t.MIN_KEY:t.MAX_KEY,v),upperOpen:!0}}function m(c){var v=c.query.index;return v.isVirtual?D(D({},c),{query:{index:v,range:p(c.query.range,v.keyTail)}}):c}var f=D(D({},n),{schema:D(D({},r),{primaryKey:u,indexes:a,getIndexByKeyPath:h}),count:function(c){return n.count(m(c))},query:function(c){return n.query(m(c))},openCursor:function(c){var v=c.query.index,w=v.keyTail,_=v.isVirtual,b=v.keyLength;if(!_)return n.openCursor(c);function g(y){function E(S){S!=null?y.continue(st(S,c.reverse?t.MAX_KEY:t.MIN_KEY,w)):c.unique?y.continue(y.key.slice(0,b).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,w)):y.continue()}var A=Object.create(y,{continue:{value:E},continuePrimaryKey:{value:function(S,K){y.continuePrimaryKey(st(S,t.MAX_KEY,w),K)}},primaryKey:{get:function(){return y.primaryKey}},key:{get:function(){var S=y.key;return b===1?S[0]:S.slice(0,b)}},value:{get:function(){return y.value}}});return A}return n.openCursor(m(c)).then(function(y){return y&&g(y)})}});return f}})}var $i={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Xi};function Kn(t,e,n,r){return n=n||{},r=r||"",N(t).forEach(function(i){if(!H(e,i))n[r+i]=void 0;else{var a=t[i],o=e[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var u=Ut(a),s=Ut(o);u!==s?n[r+i]=e[i]:u==="Object"?Kn(a,o,n,r+i+"."):a!==o&&(n[r+i]=e[i])}else a!==o&&(n[r+i]=e[i])}}),N(e).forEach(function(i){H(t,i)||(n[r+i]=e[i])}),n}function Zi(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var ea={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return D(D({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=D(D({},n),{mutate:function(a){var o=k.trans,u=o.table(e).hook,s=u.deleting,l=u.creating,d=u.updating;switch(a.type){case"add":if(l.fire===P)break;return o._promise("readwrite",function(){return h(a)},!0);case"put":if(l.fire===P&&d.fire===P)break;return o._promise("readwrite",function(){return h(a)},!0);case"delete":if(s.fire===P)break;return o._promise("readwrite",function(){return h(a)},!0);case"deleteRange":if(s.fire===P)break;return o._promise("readwrite",function(){return p(a)},!0)}return n.mutate(a);function h(f){var c=k.trans,v=f.keys||Zi(r,f);if(!v)throw new Error("Keys missing");return f=f.type==="add"||f.type==="put"?D(D({},f),{keys:v}):D({},f),f.type!=="delete"&&(f.values=Lt([],f.values,!0)),f.keys&&(f.keys=Lt([],f.keys,!0)),ta(n,f,v).then(function(w){var _=v.map(function(b,g){var y=w[g],E={onerror:null,onsuccess:null};if(f.type==="delete")s.fire.call(E,b,y,c);else if(f.type==="add"||y===void 0){var A=l.fire.call(E,b,f.values[g],c);b==null&&A!=null&&(b=A,f.keys[g]=b,r.outbound||X(f.values[g],r.keyPath,b))}else{var S=Kn(y,f.values[g]),K=d.fire.call(E,S,b,y,c);if(K){var C=f.values[g];Object.keys(K).forEach(function(R){H(C,R)?C[R]=K[R]:X(C,R,K[R])})}}return E});return n.mutate(f).then(function(b){for(var g=b.failures,y=b.results,E=b.numFailures,A=b.lastResult,S=0;S<v.length;++S){var K=y?y[S]:v[S],C=_[S];K==null?C.onerror&&C.onerror(g[S]):C.onsuccess&&C.onsuccess(f.type==="put"&&w[S]?f.values[S]:K)}return{failures:g,results:y,numFailures:E,lastResult:A}}).catch(function(b){return _.forEach(function(g){return g.onerror&&g.onerror(b)}),Promise.reject(b)})})}function p(f){return m(f.trans,f.range,1e4)}function m(f,c,v){return n.query({trans:f,values:!1,query:{index:r,range:c},limit:v}).then(function(w){var _=w.result;return h({type:"delete",keys:_,trans:f}).then(function(b){return b.numFailures>0?Promise.reject(b.failures[0]):_.length<v?{failures:[],numFailures:0,lastResult:void 0}:m(f,D(D({},c),{lower:_[_.length-1],lowerOpen:!0}),v)})})}}});return i}})}};function ta(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function xr(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,a=0;i<e.keys.length&&a<t.length;++i)W(e.keys[i],t[a])===0&&(r.push(n?Xe(e.values[i]):e.values[i]),++a);return r.length===t.length?r:null}catch{return null}}var na={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return D(D({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=xr(r.keys,r.trans._cache,r.cache==="clone");return i?x.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Xe(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Mt;function Tn(t){return!("from"in t)}var re=function(t,e){if(this)z(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new re;return t&&"d"in t&&z(n,t),n}};Oe(re.prototype,(Mt={add:function(t){return St(this,t),this},addKey:function(t){return Je(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return Je(e,n,n)}),this}},Mt[Wt]=function(){return ln(this)},Mt));function Je(t,e,n){var r=W(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Tn(t))return z(t,{from:e,to:n,d:1});var i=t.l,a=t.r;if(W(n,t.from)<0)return i?Je(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Wn(t);if(W(e,t.to)>0)return a?Je(a,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Wn(t);W(e,t.from)<0&&(t.from=e,t.l=null,t.d=a?a.d+1:1),W(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var o=!t.r;i&&!t.l&&St(t,i),a&&o&&St(t,a)}}function St(t,e){function n(r,i){var a=i.from,o=i.to,u=i.l,s=i.r;Je(r,a,o),u&&n(r,u),s&&n(r,s)}Tn(e)||n(t,e)}function ra(t,e){var n=ln(e),r=n.next();if(r.done)return!1;for(var i=r.value,a=ln(t),o=a.next(i.from),u=o.value;!r.done&&!o.done;){if(W(u.from,i.to)<=0&&W(u.to,i.from)>=0)return!0;W(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(o=a.next(i.from)).value}return!1}function ln(t){var e=Tn(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&W(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||W(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Wn(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=D({},t),u=t[i];t.from=u.from,t.to=u.to,t[i]=u[i],o[i]=u[a],t[a]=o,o.d=zn(o)}t.d=zn(t)}function zn(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var ia={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new re(t.MIN_KEY,t.MAX_KEY);return D(D({},t),{table:function(r){var i=t.table(r),a=i.schema,o=a.primaryKey,u=o.extractKey,s=o.outbound,l=D(D({},i),{mutate:function(p){var m=p.trans,f=m.mutatedParts||(m.mutatedParts={}),c=function(A){var S="idb://"+e+"/"+r+"/"+A;return f[S]||(f[S]=new re)},v=c(""),w=c(":dels"),_=p.type,b=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[],g=b[0],y=b[1],E=p.trans._cache;return i.mutate(p).then(function(A){if(U(g)){_!=="delete"&&(g=A.results),v.addKeys(g);var S=xr(g,E);!S&&_!=="add"&&w.addKeys(g),(S||y)&&aa(c,a,S,y)}else if(g){var K={from:g.lower,to:g.upper};w.add(K),v.add(K)}else v.add(n),w.add(n),a.indexes.forEach(function(C){return c(C.name).add(n)});return A})}}),d=function(p){var m,f,c=p.query,v=c.index,w=c.range;return[v,new re((m=w.lower)!==null&&m!==void 0?m:t.MIN_KEY,(f=w.upper)!==null&&f!==void 0?f:t.MAX_KEY)]},h={get:function(p){return[o,new re(p.key)]},getMany:function(p){return[o,new re().addKeys(p.keys)]},count:d,query:d,openCursor:d};return N(h).forEach(function(p){l[p]=function(m){var f=k.subscr;if(f){var c=function(E){var A="idb://"+e+"/"+r+"/"+E;return f[A]||(f[A]=new re)},v=c(""),w=c(":dels"),_=h[p](m),b=_[0],g=_[1];if(c(b.name||"").add(g),!b.isPrimaryKey)if(p==="count")w.add(n);else{var y=p==="query"&&s&&m.values&&i.query(D(D({},m),{values:!1}));return i[p].apply(this,arguments).then(function(E){if(p==="query"){if(s&&m.values)return y.then(function(C){var R=C.result;return v.addKeys(R),E});var A=m.values?E.result.map(u):E.result;m.values?v.addKeys(A):w.addKeys(A)}else if(p==="openCursor"){var S=E,K=m.values;return S&&Object.create(S,{key:{get:function(){return w.addKey(S.primaryKey),S.key}},primaryKey:{get:function(){var C=S.primaryKey;return w.addKey(C),C}},value:{get:function(){return K&&v.addKey(S.primaryKey),S.value}}})}return E})}}return i[p].apply(this,arguments)}}),l}})}};function aa(t,e,n,r){function i(a){var o=t(a.name||"");function u(l){return l!=null?a.extractKey(l):null}var s=function(l){return a.multiEntry&&U(l)?l.forEach(function(d){return o.addKey(d)}):o.addKey(l)};(n||r).forEach(function(l,d){var h=n&&u(n[d]),p=r&&u(r[d]);W(h,p)!==0&&(h!=null&&s(h),p!=null&&s(p))})}e.indexes.forEach(i)}var Cn=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=D({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:P,dbReadyPromise:null,cancelOpen:P,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new x(function(u){o.dbReadyResolve=u}),o.openCanceller=new x(function(u,s){o.cancelOpen=s}),this._state=o,this.name=e,this.on=tt(this,"populate","blocked","versionchange","close",{ready:[mn,P]}),this.on.ready.subscribe=Jn(this.on.ready.subscribe,function(u){return function(s,l){t.vip(function(){var d=r._state;if(d.openComplete)d.dbOpenError||x.resolve().then(s),l&&u(s);else if(d.onReadyBeingFired)d.onReadyBeingFired.push(s),l&&u(s);else{u(s);var h=r;l||u(function p(){h.on.ready.unsubscribe(s),h.on.ready.unsubscribe(p)})}})}}),this.Collection=_i(this),this.Table=vi(this),this.Transaction=Ti(this),this.Version=zi(this),this.WhereClause=ki(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+u.oldVersion/10)}),this._maxKey=Ge(n.IDBKeyRange),this._createTransaction=function(u,s,l,d){return new r.Transaction(u,s,l,r._options.chromeTransactionDurability,d)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),Ue.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(u)})},this.use($i),this.use(ea),this.use(ia),this.use(na),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(function(u){return u(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new T.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new T.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(Pi),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||k.letThrough||this._vip)?e():new x(function(r,i){if(n._state.openComplete)return i(new T.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new T.DatabaseClosed);return}n.open().catch(P)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,a=e.name;a&&this.unuse({stack:n,name:a});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i??10,name:a}),o.sort(function(u,s){return u.level-s.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},t.prototype.open=function(){return Gi(this)},t.prototype._close=function(){var e=this._state,n=Ue.indexOf(this);if(n>=0&&Ue.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new x(function(r){e.dbReadyResolve=r}),e.openCanceller=new x(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new T.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new x(function(i,a){var o=function(){e.close();var u=e._deps.indexedDB.deleteDatabase(e.name);u.onsuccess=F(function(){Yi(e._deps,e.name),i()}),u.onerror=ee(a),u.onblocked=e._fireOnBlocked};if(n)throw new T.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return N(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=Ji.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,a=k.trans;(!a||a.db!==this||e.indexOf("!")!==-1)&&(a=null);var o=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(d){var h=d instanceof i.Table?d.name:d;if(typeof h!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return h}),e=="r"||e===Dt)u=Dt;else if(e=="rw"||e==Rt)u=Rt;else throw new T.InvalidArgument("Invalid transaction mode: "+e);if(a){if(a.mode===Dt&&u===Rt)if(o)a=null;else throw new T.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(d){if(a&&a.storeNames.indexOf(d)===-1)if(o)a=null;else throw new T.SubTransaction("Table "+d+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(d){return a?a._promise(null,function(h,p){p(d)}):j(d)}var l=Sr.bind(null,this,u,s,a,r);return a?a._promise(u,l,"lock"):k.trans?Ie(k.transless,function(){return i._whenReady(l)}):this._whenReady(l)},t.prototype.table=function(e){if(!H(this._allTables,e))throw new T.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),oa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ua=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[oa]=function(){return this},t}();function Ar(t,e){return N(e).forEach(function(n){var r=t[n]||(t[n]=new re);St(r,e[n])}),t}function sa(t){return new ua(function(e){var n=pn(t);function r(m){n&&Be();var f=function(){return pe(t,{subscr:m,trans:null})},c=k.trans?Ie(k.transless,f):f();return n&&c.then(se,se),c}var i=!1,a={},o={},u={get closed(){return i},unsubscribe:function(){i=!0,ye.storagemutated.unsubscribe(h)}};e.start&&e.start(u);var s=!1,l=!1;function d(){return N(o).some(function(m){return a[m]&&ra(a[m],o[m])})}var h=function(m){Ar(a,m),d()&&p()},p=function(){if(!(s||i)){a={};var m={},f=r(m);l||(ye(Qe,h),l=!0),s=!0,Promise.resolve(f).then(function(c){s=!1,!i&&(d()?p():(a={},o=m,e.next&&e.next(c)))},function(c){s=!1,e.error&&e.error(c),u.unsubscribe()})}};return p(),u})}var cn;try{cn={indexedDB:M.indexedDB||M.mozIndexedDB||M.webkitIndexedDB||M.msIndexedDB,IDBKeyRange:M.IDBKeyRange||M.webkitIDBKeyRange}}catch{cn={indexedDB:null,IDBKeyRange:null}}var me=Cn;Oe(me,D(D({},kt),{delete:function(t){var e=new me(t,{addons:[]});return e.delete()},exists:function(t){return new me(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return qi(me.dependencies).then(t)}catch{return j(new T.MissingAPI)}},defineClass:function(){function t(e){z(this,e)}return t},ignoreTransaction:function(t){return k.trans?Ie(k.transless,t):t()},vip:un,async:function(t){return function(){try{var e=sn(t.apply(this,arguments));return!e||typeof e.then!="function"?x.resolve(e):e}catch(n){return j(n)}}},spawn:function(t,e,n){try{var r=sn(t.apply(n,e||[]));return!r||typeof r.then!="function"?x.resolve(r):r}catch(i){return j(i)}},currentTransaction:{get:function(){return k.trans||null}},waitFor:function(t,e){var n=x.resolve(typeof t=="function"?me.ignoreTransaction(t):t).timeout(e||6e4);return k.trans?k.trans.waitFor(n):n},Promise:x,debug:{get:function(){return te},set:function(t){nr(t,t==="dexie"?function(){return!0}:yr)}},derive:De,extend:z,props:Oe,override:Jn,Events:tt,on:ye,liveQuery:sa,extendObservabilitySet:Ar,getByKeyPath:oe,setByKeyPath:X,delByKeyPath:Lr,shallowClone:Zn,deepClone:Xe,getObjectDiff:Kn,cmp:W,asap:Xn,minKey:en,addons:[],connections:Ue,errnames:yn,dependencies:cn,semVer:Fn,version:Fn.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));me.maxKey=Ge(me.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ye(Qe,function(t){if(!ae){var e;Kt?(e=document.createEvent("CustomEvent"),e.initCustomEvent(de,!0,!0,t)):e=new CustomEvent(de,{detail:t}),ae=!0,dispatchEvent(e),ae=!1}}),addEventListener(de,function(t){var e=t.detail;ae||xt(e)}));function xt(t){var e=ae;try{ae=!0,ye.storagemutated.fire(t)}finally{ae=e}}var ae=!1;if(typeof BroadcastChannel<"u"){var qn=new BroadcastChannel(de);ye(Qe,function(t){ae||qn.postMessage(t)}),qn.onmessage=function(t){t.data&&xt(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ye(Qe,function(t){try{ae||(typeof localStorage<"u"&&localStorage.setItem(de,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&Lt([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:de,changedParts:t})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(t){if(t.key===de){var e=JSON.parse(t.newValue);e&&xt(e.changedParts)}});var Hn=self.document&&navigator.serviceWorker;Hn&&Hn.addEventListener("message",la)}function la(t){var e=t.data;e&&e.type===de&&xt(e.changedParts)}x.rejectionMapper=Gr;nr(te,yr);function ca(t,e,n=30,r=null){let i=[];for(let a of t){a={...a},delete a.limit,delete a.since,delete a.until;let o=new Map;for(let u of da(a))o.set(JSON.stringify(u),[]);for(let u of e)fa(o,a,u);for(let[u,s]of o)ha(i,u,s,n,r)}return i}function Fe(t,e,n,r,i=null,a=!1){if(n){if(e[n]&&e[n].length>1){for(let o of e[n])if(a){for(let u of r.tags)if(u[0]==i&&u[1]===o){Ft(t,{...e,[n]:[o]},r);break}}else if(i!=null&&r[i]===o){Ft(t,{...e,[n]:[o]},r);break}return!0}return!1}else Ft(t,e,r)}function Ft(t,e,n){let r=JSON.stringify(e),i=t.get(r);i?i.push(n):t.set(r,[n])}function fa(t,e,n){Fe(t,e,"authors",n,"pubkey",!1)||Fe(t,e,"ids",n,"ids",!1)||Fe(t,e,"#p",n,"p",!0)||Fe(t,e,"#e",n,"e",!0)||Fe(t,e,null,n)}function ha(t,e,n,r,i){n=n.sort((a,o)=>a.created_at-o.created_at);for(let a=0;a<n.length;a+=r)r>1||n.length==1?t.push({filter:e,events:n.slice(a,a+r)}):t.push({filter:e,event:n[a]});i&&t.push({filter:e,query_info:i})}function da(t){let e=[];if(t.authors&&t.authors.length>1)for(let n of t.authors)e.push({...t,authors:[n]});else if(t.ids&&t.ids.length>1)for(let n of t.ids)e.push({...t,ids:[n]});else if(t["#p"]&&t["#p"].length>1)for(let n of t["#p"])e.push({...t,"#p":[n]});else if(t["#e"]&&t["#e"].length>1)for(let n of t["#e"])e.push({...t,"#e":[n]});else e.push(t);return e}class pa extends Cn{constructor(){super("nostr_events",{chromeTransactionDurability:"relaxed"}),this.version(1).stores({events:"++,filter"})}}const kr=new pa;function Ne(t,e,n){return e?t[e]&&t[e].length>1?n.anyOf(t[e].map(r=>JSON.stringify({...t,[e]:[r]}))):null:n.equals(JSON.stringify(t))}function va(t,e){let n=Ne(t,"authors",e)||Ne(t,"ids",e)||Ne(t,"#p",e)||Ne(t,"#e",e)||Ne(t,null,e);if(!n)throw new Error("splitWhereClause bug");return n}function Kr(t,e,n=30,r=null){console.log("putEvents called with ",e.length," events");let i=ca(t,e,n,r);return kr.events.bulkPut(i)}function ya(t){let e;for(let n of t){let r=e?e.or("filter"):kr.events.where("filter");n={...n},delete n.limit,e=va(n,r)}return e?e.toArray().then(n=>{let r=n.map(a=>a.events||a.event||[]).flat(),i=n.filter(a=>a.query_info);return{events:r,query_infos:i}}):new Promise(n=>({events:[],query_infos:[]}))}function ma(t,e){return t.reduce((n,r)=>(n[e(r)]=r,n),new Map)}function On(t,e){return t.reduce((n,r)=>{const i=e(r);return n.get(i)||n.set(i,[]),n.get(i).push(r),n},new Map)}function ga(t){return[...new Set(t)]}function ba(t,e){return new Map(Array.from(t.entries()).map(([n,r])=>[n,e(r)]))}function _a(t,e){if(e={...e},e.ids){if(e.ids=e.ids.filter(n=>!t.find(r=>r.id==Ce(n))),!e.ids.length)return null}else if(e.authors){if(e.authors=e.authors.filter(n=>!t.find(r=>r.pubkey==Ce(n))),!e.authors.length)return null}else throw new Error("onlyOne option not supported for this filter"+JSON.stringify(e));return e}function wa(t,e,n,r,i){let a=[];for(let o of e){o={...o};let u=n.onlyOne;if(o.ids&&o.ids.length==0||o.authors&&o.authors.length==0||o.kinds&&o.kinds.length==0){console.timeLog(t,"no need to send subscription because filter is empty");continue}if(o.ids&&(u=!0),u){let l=_a(r,o);if(!l){console.timeLog(t,"no need to send subscription because all events are already in the database");continue}o=l}if(o.authors&&!o.retrieve_old){console.log("splitting by authors",o.authors),console.log("events",r);let l=On(r,p=>p.pubkey),d=ba(l,p=>Math.max(...p.map(m=>m.created_at)));console.log("last_created_at_by_author",d);let h=[];for(let p of o.authors){let m=d.get(Ce(p));if(m==null)h.push(p);else{let f={...o};f.authors=[p],f.since=m+1,a.push(vt(f))}}if(h.length==0)continue;o.authors=h}let s=!1;for(let l of Object.keys(o)){if(!l.startsWith("#"))continue;let d=o[l];console.log("Splitting by tag",l,d);let h=[];for(let p of d){let m=l.slice(1),f=Math.max(...r.filter(c=>c.tags.find(v=>v[0]==m&&v[1]==p)).map(c=>c.created_at));if(console.log("last_created_at",f,m,p),f==null)h.push(p);else{let c={...o};c[l]=[p],c.since=f+1,a.push(vt(c))}}if(h.length==0){s=!0;break}o[l]=h}s||a.push(vt(o))}if(a.length!=0)return a}let Ce=t=>typeof t=="string"?t:t[0];function vt(t){let e={};t.ids&&(e.ids=t.ids.map(Ce)),t.kinds&&(e.kinds=t.kinds),t.authors&&(e.authors=t.authors.map(Ce)),t.since&&(e.since=t.since),t.until&&(e.until=t.until),t.limit&&(e.limit=t.limit);for(let n of Object.keys(t))n.startsWith("#")&&(e[n]=t[n].map(Ce));return e}function Ea(t){var e,n;let r=!1,i=[];var a={},o={connect:[],disconnect:[],error:[],notice:[]},u={},s={};async function l(){return new Promise((m,f)=>{e=new WebSocket(t),e.onopen=()=>{r=!0;for(let c in a)h(["REQ",c,...a[c].filters]);for(let c of i)e.send(c);i=[],o.connect.forEach(c=>c()),m()},e.onerror=()=>{o.error.forEach(c=>c()),f()},e.onclose=async()=>{r=!1,o.disconnect.forEach(c=>c()),n&&n()},e.onmessage=async c=>{var w,_,b,g;var v;try{v=JSON.parse(c.data)}catch{v=c.data}if(v.length>=1)switch(v[0]){case"EVENT":if(v.length!==3)return;let y=v[1],E=v[2];Br(E)&&a[y]&&(a[y].skipVerification||Ir(E))&&Pr(a[y].filters,E)&&(a[y],(((w=u[y])==null?void 0:w.event)||[]).forEach(S=>S(E)));return;case"EOSE":{if(v.length!==2)return;let S=v[1];(((_=u[S])==null?void 0:_.eose)||[]).forEach(K=>K());return}case"OK":{if(v.length<3)return;let S=v[1],K=v[2],C=v[3]||"";K?(b=s[S])==null||b.ok.forEach(R=>R()):(g=s[S])==null||g.failed.forEach(R=>R(C));return}case"NOTICE":if(v.length!==2)return;let A=v[1];o.notice.forEach(S=>S(A));return}}})}async function d(){e!=null&&e.readyState&&e.readyState===1||await l()}async function h(m){let f=JSON.stringify(m);r?e.send(f):i.push(f)}const p=(m,{skipVerification:f=!1,id:c=Math.random().toString().slice(2)}={})=>{let v=c;return a[v]={id:v,filters:m,skipVerification:f},r&&h(["REQ",v,...m]),{sub:(w,_={})=>p(w||m,{skipVerification:_.skipVerification||f,id:v}),unsub:()=>{delete a[v],delete u[v],r&&h(["CLOSE",v])},on:(w,_)=>{u[v]=u[v]||{event:[],eose:[]},u[v][w].push(_)},off:(w,_)=>{let b=u[v],g=b[w].indexOf(_);g>=0&&b[w].splice(g,1)}}};return{url:t,sub:p,on:(m,f)=>{o[m].push(f),m==="connect"&&(e==null?void 0:e.readyState)===1&&f()},off:(m,f)=>{let c=o[m].indexOf(f);c!==-1&&o[m].splice(c,1)},publish(m){if(!m.id)throw new Error(`event ${m} has no id`);let f=m.id;var c=!1,v=!1;h(["EVENT",m]).then(()=>{c=!0,v&&(w(),v=!1)}).catch(()=>{});const w=()=>{let _=p([{ids:[f]}],{id:`monitor-${f.slice(0,5)}`}),b=setTimeout(()=>{var g;(((g=s[f])==null?void 0:g.failed)||[]).forEach(y=>y("event not seen after 5 seconds")),_.unsub()},5e3);_.on("event",()=>{var g;clearTimeout(b),(((g=s[f])==null?void 0:g.seen)||[]).forEach(y=>y())})};return{on:(_,b)=>{s[f]=s[f]||{ok:[],seen:[],failed:[]},s[f][_].push(b),_==="seen"&&(c?w():v=!0)},off:(_,b)=>{let g=s[f];if(!g)return;let y=g[_].indexOf(b);y>=0&&g[_].splice(y,1)}}},connect:d,close(){return e.close(),new Promise(m=>{n=m})},get status(){return(e==null?void 0:e.readyState)??3}}}let Nt=t=>[...new Set(t)];class Sa{constructor(e){if(this.relayByUrl=new Map,e)for(let n of Nt(e))this.addOrGetRelay(n)}addOrGetRelay(e){let n=this.relayByUrl.get(e);return n||(n=Ea(e),this.relayByUrl.set(e,n),n.connect(),n)}close(){for(let e of this.relayByUrl.values())e.close();this.relayByUrl.clear()}sub(e,n){n=Nt(n);let r=[];for(let i of n){let a=this.addOrGetRelay(i);r.push(a.sub(e))}return new xa(r,n)}publish(e,n){for(let r of Nt(n))this.addOrGetRelay(r).publish(e)}onnotice(e){this.relayByUrl.forEach((n,r)=>n.on("notice",i=>e(r+": "+i)))}onerror(e){this.relayByUrl.forEach((n,r)=>n.on("error",i=>e(r+": "+i)))}ondisconnect(e){this.relayByUrl.forEach((n,r)=>n.on("disconnect",i=>e(r+": "+i)))}}class xa{constructor(e,n){this.subscriptions=e,this.eventsBySub=new Map,this.urlsBySub=new Map;for(let r=0;r<e.length;r++)this.urlsBySub.set(e[r],n[r])}onevent(e){return this.subscriptions.forEach(n=>{this.eventsBySub.set(n,[]),n.on("event",r=>{let i=this.eventsBySub.get(n);i&&i.push(r),e(r,i===void 0,this.urlsBySub.get(n))})}),()=>{this.subscriptions.forEach(n=>n.off("event",e))}}oneose(e){return this.subscriptions.forEach(n=>n.on("eose",()=>{let r=this.eventsBySub.get(n);this.eventsBySub.delete(n),e(r,this.urlsBySub.get(n))})),()=>{this.subscriptions.forEach(n=>n.off("eose",e))}}unsub(){this.subscriptions.forEach(e=>e.unsub())}}let jt=0,Tr=["wss://relay.damus.io","wss://nostr.fmt.wiz.biz","wss://nostr.bongbong.com","wss://nostr-2.zebedee.cloud","wss://nostr.zaprite.io","wss://relay.nostr.ch","wss://nostr.delo.software","wss://nostr.nodeofsven.com","wss://nostr.oxtr.dev","wss://nostr-relay.wlvs.space"];const Ct=new Sa(Tr);Ct.onerror=t=>{console.log("RelayPool error",t)};Ct.onnotice(t=>{console.log("RelayPool notice",t)});function Dn(t,e){for(let n of t)if(n.id==e)return!0;return!1}let Aa=t=>{var e;(e=t.sub)==null||e.unsub(),t.sub=void 0};function ka(t,e){t.query_info.eose_received_at=fn(),t.query_info.total_events=t.events.length,t.query_info.new_events=e.length;let n=e.filter(r=>!Dn(t.events,r.id));console.timeLog(t.label,"EOSE with "+e.length+" events, from that "+e.length+" new, total events: ",t.events.length),console.log("Writing query info",t.query_info),Kr(t.filters,n,void 0,t.query_info),t.changed&&t.callback&&t.callback(t.events)}function Ka(t,e,n){t.changed=!0,t.events.push(e);let r=!1;n?(r=!0,console.time("callback"),t.callback(t.events),console.timeEnd("callback")):t.newEvents.push(e),r&&(Dn(t.storedEvents,e.id)||(Kr(t.filters,[e]),t.storedEvents.push(e)))}function Ta(t,e,n){t.query_info.received_events++,Dn(t.events,e.id)||Ka(t,e,n)}Ct.ondisconnect(t=>{console.log("relay disconnected",t)});function Ca(t){console.log("relay.sub",t.subText,...t.filters);let e=Ct.sub(t.filters,Tr);t.sub=e,e.onevent((n,r)=>{console.log("event",t.subText,n),Ta(t,n,r)}),e.oneose((n,r)=>{console.log("eose received at",r),n?ka(t,n):console.warn("eose received without events (server sent eose twice")})}const fn=()=>Math.floor(Date.now()/1e3);function Cr(t,e,n={}){let r=JSON.stringify(t);console.time(r);let i="sub"+jt;jt=jt+1;let a=fn(),o;return ya(t.map(vt)).then(({events:u,query_infos:s})=>{let l=u.length;u.length&&e(u);let d=wa(r,t,n,u);console.timeLog(r,`got ${l} indexedDB events for filter, query_infos`,s,"filter_result",d),d&&(o={events:u,callback:e,filters:d,changed:!1,options:n,label:r,subText:i,newEvents:[],storedEvents:u,query_info:{db_queried_at:a,req_sent_at:fn(),received_events:0}},console.log("sending subscription REQ",i,...o.filters,", original label",o.label,", req_sent_at",o.query_info.req_sent_at),Ca(o))}),()=>{o&&(console.timeEnd(o.label),Aa(o),o.callback=null)}}function Pe(t,e){return Yn([],function(r){return Cr(t,r,e)})}function Rn(t,e,n){let r=null;return Yn([],function(a){return t.subscribe(o=>{r&&r(),r=Cr(e(o),a,n)}),()=>{r&&r()}})}let Oa=(t,e=500)=>Pe([{authors:[t],limit:e}]),Da=(t,e=500)=>Pe([{"#p":[t],limit:e}]),Ra=(t,e)=>Rn(t,n=>{let r={kinds:[0],authors:[e]};console.log("filtering profiles",n);for(let i=0;i<n.length;i++){let a=n[i];r.authors=ga(r.authors.concat(a.tags.filter(o=>o[0]=="p"&&o[1]&&o[1].length>8).map(o=>o[1])))}return[r]},{onlyOne:!0}),Ba=t=>hn(t,e=>ma(e,n=>n.pubkey)),Ia=t=>hn(t,e=>{var r;return((r=e.findLast(i=>i.kind===ge.Contacts))==null?void 0:r.tags.map(i=>i[1]))||[]}),Pa=t=>e=>e.filter(n=>n.kind===t),Ma=(t,e=500)=>Rn(t,n=>[{authors:n,limit:e}]),Or=t=>{let e=t.filter(i=>i.kind==ge.Text).map(i=>i.tags).flat().filter(i=>i[0]=="e").map(i=>i.slice(1)),n=On(e,i=>i[0]),r=[];for(let[i,a]of n){let o=a.map(u=>u.slice(1)).flat();r.push([i,...new Set(o)])}return{ids:r}},Fa=t=>hn(Pe([Or(t)],{onlyOne:!0}),e=>On(e,n=>n.id));function Na(t,e=null){const{subscribe:n,set:r}=Qn(JSON.parse(localStorage.getItem(t))||e);return{subscribe:n,set:i=>{localStorage.setItem(t,JSON.stringify(i)),r(i)}}}function Dr(t,e=null){const{subscribe:n,set:r}=Qn(localStorage.getItem(t)||e);return{subscribe:n,set:i=>{localStorage.setItem(t,i),r(i)}}}let ja=()=>Dr("nostr_profile_state");async function La(t){let e=Pe([{kinds:[ge.Contacts],authors:[t]}],{onlyOne:!0});return new Promise((n,r)=>{e.subscribe(i=>{i.length>0&&n(i[0].tags.filter(a=>a[0]=="p").map(a=>a[1]))})})}let Va=(t,e)=>Pe([{authors:[t],limit:200},{"#p":[t],limit:200},{authors:[t],kinds:[ge.Contacts]},{authors:[t],kinds:[ge.Metadata]},{authors:e,limit:50},{"#p":e,limit:50},{authors:e,kinds:[ge.Contacts]},{authors:e,kinds:[ge.Metadata]}]);const za=Object.freeze(Object.defineProperty({__proto__:null,subscribeAndCacheResultsStore:Pe,derivedSubscribeStore:Rn,publishedStore:Oa,receivedStore:Da,publishedProfilesStore:Ra,publishedProfilesByPubKeyStore:Ba,contactsStore:Ia,filterByKind:Pa,eventsFromFollowedStore:Ma,repliesFilter:Or,repliesStore:Fa,localStorageJSONStore:Na,localStorageStore:Dr,profileStateLocalStore:ja,getFollowed:La,getEvents:Va},Symbol.toStringTag,{value:"Module"}));export{Va as a,ya as b,za as c,On as g,ma as m,Or as r,Pe as s};
